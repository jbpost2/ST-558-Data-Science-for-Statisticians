<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2025-05-07">

<title>Manipulating Data with dplyr – ST 558 Data Science for Statisticians (R)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../Notes/20-Manipulating_Data_with_tidyr.html" rel="next">
<link href="../Notes/18-Reading_Excel_Data.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">ST 558 Data Science for Statisticians (R)</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="../index.html" aria-current="page"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/jbpost2/ST-558-Data-Science-for-Statisticians"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../Notes/16-Tidyverse_Essentials.html">Topic 2: Tidyverse &amp; EDA</a></li><li class="breadcrumb-item"><a href="../Notes/19-Manipulating_Data_with_dplyr.html">Manipulating Data with <code>dplyr</code></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Science for Statisticians</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">Topic 1: Data Science &amp; R Basics</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/00-Welcome_to_the_Course.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome to the Course!</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/01-What_is_Data_Science.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">What is Data Science?</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/02-Workflows_Git_GitHub_Basics_Landing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Workflows &amp; `Git`/`GitHub` Basics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/03-Git_GitHub_Practice.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">`Git` &amp; `GitHub` Practice</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/04-R_Basics_Landing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><code>R</code> Basics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/05-R_Projects_Connecting_with_GitHub.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R projects and Connecting with Github</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/06-Quarto.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Quarto Basics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/07-Base_R_Data_Structures_Vectors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Base R Data Structures: Vectors</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/08-Base_R_Data_Structures_Matrices.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Base R Data Structures: Matrices</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/09-Base_R_Data_Structures_Data_Frames.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Base R Data Structures: Data Frames</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/10-Base_R_Data_Structures_Lists.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Base R Data Structures: Lists</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/11-Control_Flow_Logicals_if_then_else.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Control Flow: Logicals &amp; if/then/else</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/12-Control_Flow_Loops.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Control Flow: Loops</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/13-Control_Flow_Vectorized_Functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Control Flow: Vectorized Functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/14-Writing_Functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Writing Functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/15-Packages_Landing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Course Goals &amp; Other Resources</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Topic 2: Tidyverse &amp; EDA</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/16-Tidyverse_Essentials.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tidyverse Essentials</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/17-Reading_Delimited_Data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Reading Delimited Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/18-Reading_Excel_Data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Reading Excel Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/19-Manipulating_Data_with_dplyr.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Manipulating Data with <code>dplyr</code></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/20-Manipulating_Data_with_tidyr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Manipulating Data with <code>tidyr</code></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/21-Connecting_to_Databases.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Databases and Basic SQL</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/22-SQL_Style_Joins_Landing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Course Goals &amp; Other Resources</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/23-Querying_APIs_Landing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Course Goals &amp; Other Resources</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/24-Summarizing_Categorical_Variables.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Creating Contingency Tables</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/25-Barplots_ggplot_Basics_Landing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Course Goals &amp; Other Resources</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/26-Numerical_Variable_Summaries.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Numerical Variable Summaries</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/27-Numeric_Variable_Graphs_Landing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Course Goals &amp; Other Resources</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">Topic 3: Other Programming Topics</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/28-Big_Recap_Landing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Course Goals &amp; Other Resources</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/29-Apply_Family_Landing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Course Goals &amp; Other Resources</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/30-purrr_Landing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Course Goals &amp; Other Resources</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/31-Advanced_Function_Writing_Landing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Course Goals &amp; Other Resources</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#coercing-a-data-frame-to-a-tibble" id="toc-coercing-a-data-frame-to-a-tibble" class="nav-link active" data-scroll-target="#coercing-a-data-frame-to-a-tibble">Coercing a Data Frame to a Tibble</a></li>
  <li><a href="#row-manipulations-with-dplyr" id="toc-row-manipulations-with-dplyr" class="nav-link" data-scroll-target="#row-manipulations-with-dplyr">Row Manipulations with <code>dplyr</code></a>
  <ul class="collapse">
  <li><a href="#filter" id="toc-filter" class="nav-link" data-scroll-target="#filter"><code>filter()</code></a></li>
  <li><a href="#arrange" id="toc-arrange" class="nav-link" data-scroll-target="#arrange"><code>arrange()</code></a></li>
  </ul></li>
  <li><a href="#column-manipulations-with-dplyr" id="toc-column-manipulations-with-dplyr" class="nav-link" data-scroll-target="#column-manipulations-with-dplyr">Column Manipulations with <code>dplyr</code></a>
  <ul class="collapse">
  <li><a href="#select---subset-columns" id="toc-select---subset-columns" class="nav-link" data-scroll-target="#select---subset-columns"><code>select()</code> - Subset Columns</a></li>
  <li><a href="#rename" id="toc-rename" class="nav-link" data-scroll-target="#rename"><code>rename()</code></a></li>
  <li><a href="#creating-new-variables-with-dplyr" id="toc-creating-new-variables-with-dplyr" class="nav-link" data-scroll-target="#creating-new-variables-with-dplyr">Creating New Variables with <code>dplyr</code></a></li>
  <li><a href="#quick-r-video" id="toc-quick-r-video" class="nav-link" data-scroll-target="#quick-r-video">Quick R Video</a></li>
  <li><a href="#recap" id="toc-recap" class="nav-link" data-scroll-target="#recap">Recap!</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../Notes/16-Tidyverse_Essentials.html">Topic 2: Tidyverse &amp; EDA</a></li><li class="breadcrumb-item"><a href="../Notes/19-Manipulating_Data_with_dplyr.html">Manipulating Data with <code>dplyr</code></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Manipulating Data with <code>dplyr</code></h1>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">2025-05-07</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p>Thinking about our big goals (doing data science):</p>
<ul>
<li>Read in raw data and manipulate it</li>
<li>Combine data sources</li>
<li>Summarize data to glean insights</li>
<li>Apply common analysis methods</li>
<li>Communicate Effectively</li>
</ul>
<p>We now have a good idea about reading in certain types of data. Let’s take a bit of time going through common data manipulation tasks before returning to reading data in.</p>
<p>The two major tasks we’ll consider are</p>
<ul>
<li><p>Row manipulations</p>
<ul>
<li><strong>filtering</strong> or subsetting our observations</li>
<li><strong>arranging</strong> our observations in some order</li>
</ul></li>
<li><p>Column manipulations</p>
<ul>
<li><strong>selecting</strong> a subset of our variables</li>
<li><strong>rename</strong> a column</li>
<li><strong>mutating</strong> our data frame to create a new variable</li>
</ul></li>
</ul>
<p>We can use BaseR for this (via <code>[</code> or the <code>subset()</code> function). However, the <code>tidyverse</code> has a more coherent set of functions to allow us to do all of our tasks without having to spend as much time learning syntax. So let’s go that route!</p>
<p>Recall the basic fundamentals about the <code>tidyverse</code>:</p>
<ul>
<li><p>(Almost) all functions take in <code>tibble</code>s (special data frames) and output <code>tibble</code>s</p></li>
<li><p>(Almost) all functions have similar syntax!</p>
<p><code>function(tibble, arguments, ...)</code></p>
<ul>
<li>Allows for easy chaining!</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>my_data <span class="sc">|&gt;</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(var1<span class="sc">:</span>var10, var20) <span class="sc">|&gt;</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(var1 <span class="sc">==</span> <span class="st">"first"</span>) <span class="sc">|&gt;</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">new_var =</span> <span class="fu">lag</span>(var20)) <span class="sc">|&gt;</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  ...</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="coercing-a-data-frame-to-a-tibble" class="level2">
<h2 class="anchored" data-anchor-id="coercing-a-data-frame-to-a-tibble">Coercing a Data Frame to a Tibble</h2>
<p>If you happen to have a data frame that isn’t already a tibble, we can easily coerce it using the <code>as_tibble()</code> function.</p>
<p>Consider a data set on major league baseball players (batting statistics):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Lahman)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'Lahman' was built under R version 4.1.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>batting_tbl <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(Batting)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>batting_tbl</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 108,789 x 22
   playerID  yearID stint teamID lgID      G    AB     R     H   X2B   X3B    HR
   &lt;chr&gt;      &lt;int&gt; &lt;int&gt; &lt;fct&gt;  &lt;fct&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
 1 abercda01   1871     1 TRO    NA        1     4     0     0     0     0     0
 2 addybo01    1871     1 RC1    NA       25   118    30    32     6     0     0
 3 allisar01   1871     1 CL1    NA       29   137    28    40     4     5     0
 4 allisdo01   1871     1 WS3    NA       27   133    28    44    10     2     2
 5 ansonca01   1871     1 RC1    NA       25   120    29    39    11     3     0
 6 armstbo01   1871     1 FW1    NA       12    49     9    11     2     1     0
 7 barkeal01   1871     1 RC1    NA        1     4     0     1     0     0     0
 8 barnero01   1871     1 BS1    NA       31   157    66    63    10     9     0
 9 barrebi01   1871     1 FW1    NA        1     5     1     1     1     0     0
10 barrofr01   1871     1 BS1    NA       18    86    13    13     2     1     0
# i 108,779 more rows
# i 10 more variables: RBI &lt;int&gt;, SB &lt;int&gt;, CS &lt;int&gt;, BB &lt;int&gt;, SO &lt;int&gt;,
#   IBB &lt;int&gt;, HBP &lt;int&gt;, SH &lt;int&gt;, SF &lt;int&gt;, GIDP &lt;int&gt;</code></pre>
</div>
</div>
<p>Nice, now we can work on this <code>tibble</code>!</p>
</section>
<section id="row-manipulations-with-dplyr" class="level2">
<h2 class="anchored" data-anchor-id="row-manipulations-with-dplyr">Row Manipulations with <code>dplyr</code></h2>
<p>A common task is to only grab certain types of observations (<strong>filter rows</strong>)</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/filterVisualF.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="500"></p>
</figure>
</div>
</div>
</div>
<p>or rearrange the order of the observations (rows). The two functions from <code>dplyr</code> that help us here are</p>
<ul>
<li><code>filter()</code> - subset <strong>rows</strong></li>
<li><code>arrange()</code> - reorder <strong>rows</strong></li>
</ul>
<section id="filter" class="level3">
<h3 class="anchored" data-anchor-id="filter"><code>filter()</code></h3>
<p><code>filter()</code> generally takes a <code>tibble</code> as its first argument and then a logical vector as the next (of the same length as the number of rows):</p>
<ul>
<li>Return observations where the number of games played is greater than 50 (the <code>G</code> column):</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(batting_tbl, G <span class="sc">&gt;</span> <span class="dv">50</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 40,168 x 22
   playerID  yearID stint teamID lgID      G    AB     R     H   X2B   X3B    HR
   &lt;chr&gt;      &lt;int&gt; &lt;int&gt; &lt;fct&gt;  &lt;fct&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
 1 bechtge01   1872     1 NY2    NA       51   247    61    74    11     3     0
 2 cummica01   1872     1 NY2    NA       55   249    37    52     9     3     0
 3 eggleda01   1872     1 NY2    NA       56   290    94    97    20     0     0
 4 hallge01    1872     1 BL1    NA       53   250    69    84    17     6     1
 5 hatfijo01   1872     1 NY2    NA       56   288    76    93    15     2     1
 6 hicksna01   1872     1 NY2    NA       56   267    54    82    12     2     0
 7 mcmuljo01   1872     1 NY2    NA       54   236    47    60     6     1     0
 8 millsev01   1872     1 BL1    NA       55   266    55    79    14     2     0
 9 pikeli01    1872     1 BL1    NA       56   285    68    85    15     5     7
10 radcljo01   1872     1 BL1    NA       56   297    70    86    13     4     1
# i 40,158 more rows
# i 10 more variables: RBI &lt;int&gt;, SB &lt;int&gt;, CS &lt;int&gt;, BB &lt;int&gt;, SO &lt;int&gt;,
#   IBB &lt;int&gt;, HBP &lt;int&gt;, SH &lt;int&gt;, SF &lt;int&gt;, GIDP &lt;int&gt;</code></pre>
</div>
</div>
<p>Notice the number of observations is far less now!</p>
<ul>
<li>Of course, we’ll do many operations so let’s use chaining even in this simple case:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>batting_tbl <span class="sc">|&gt;</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(G <span class="sc">&gt;</span> <span class="dv">50</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 40,168 x 22
   playerID  yearID stint teamID lgID      G    AB     R     H   X2B   X3B    HR
   &lt;chr&gt;      &lt;int&gt; &lt;int&gt; &lt;fct&gt;  &lt;fct&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
 1 bechtge01   1872     1 NY2    NA       51   247    61    74    11     3     0
 2 cummica01   1872     1 NY2    NA       55   249    37    52     9     3     0
 3 eggleda01   1872     1 NY2    NA       56   290    94    97    20     0     0
 4 hallge01    1872     1 BL1    NA       53   250    69    84    17     6     1
 5 hatfijo01   1872     1 NY2    NA       56   288    76    93    15     2     1
 6 hicksna01   1872     1 NY2    NA       56   267    54    82    12     2     0
 7 mcmuljo01   1872     1 NY2    NA       54   236    47    60     6     1     0
 8 millsev01   1872     1 BL1    NA       55   266    55    79    14     2     0
 9 pikeli01    1872     1 BL1    NA       56   285    68    85    15     5     7
10 radcljo01   1872     1 BL1    NA       56   297    70    86    13     4     1
# i 40,158 more rows
# i 10 more variables: RBI &lt;int&gt;, SB &lt;int&gt;, CS &lt;int&gt;, BB &lt;int&gt;, SO &lt;int&gt;,
#   IBB &lt;int&gt;, HBP &lt;int&gt;, SH &lt;int&gt;, SF &lt;int&gt;, GIDP &lt;int&gt;</code></pre>
</div>
</div>
<ul>
<li><p>If we want to return observations where than one condition is <code>TRUE</code> we can either pass additional arguments or use the compound logical operator <code>&amp;</code> we discussed earlier.</p>
<ul>
<li>Condition on those that played more than 50 games and played in 2018</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>batting_tbl <span class="sc">|&gt;</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(G <span class="sc">&gt;</span> <span class="dv">50</span> <span class="sc">&amp;</span> yearID <span class="sc">==</span> <span class="dv">2018</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 518 x 22
   playerID  yearID stint teamID lgID      G    AB     R     H   X2B   X3B    HR
   &lt;chr&gt;      &lt;int&gt; &lt;int&gt; &lt;fct&gt;  &lt;fct&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
 1 abreujo02   2018     1 CHA    AL      128   499    68   132    36     1    22
 2 acunaro01   2018     1 ATL    NL      111   433    78   127    26     4    26
 3 adamewi01   2018     1 TBA    AL       85   288    43    80     7     0    10
 4 adamsma01   2018     1 WAS    NL       94   249    37    64     9     0    18
 5 adducji02   2018     1 DET    AL       59   176    19    47     8     2     3
 6 adriaeh01   2018     1 MIN    AL      114   335    42    84    23     1     6
 7 aguilje01   2018     1 MIL    NL      149   492    80   135    25     0    35
 8 ahmedni01   2018     1 ARI    NL      153   516    61   121    33     5    16
 9 albieoz01   2018     1 ATL    NL      158   639   105   167    40     5    24
10 alexasc01   2018     1 LAN    NL       73     5     0     0     0     0     0
# i 508 more rows
# i 10 more variables: RBI &lt;int&gt;, SB &lt;int&gt;, CS &lt;int&gt;, BB &lt;int&gt;, SO &lt;int&gt;,
#   IBB &lt;int&gt;, HBP &lt;int&gt;, SH &lt;int&gt;, SF &lt;int&gt;, GIDP &lt;int&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">#equivalently</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>batting_tbl <span class="sc">|&gt;</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(G <span class="sc">&gt;</span> <span class="dv">50</span>, yearID <span class="sc">==</span> <span class="dv">2018</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 518 x 22
   playerID  yearID stint teamID lgID      G    AB     R     H   X2B   X3B    HR
   &lt;chr&gt;      &lt;int&gt; &lt;int&gt; &lt;fct&gt;  &lt;fct&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
 1 abreujo02   2018     1 CHA    AL      128   499    68   132    36     1    22
 2 acunaro01   2018     1 ATL    NL      111   433    78   127    26     4    26
 3 adamewi01   2018     1 TBA    AL       85   288    43    80     7     0    10
 4 adamsma01   2018     1 WAS    NL       94   249    37    64     9     0    18
 5 adducji02   2018     1 DET    AL       59   176    19    47     8     2     3
 6 adriaeh01   2018     1 MIN    AL      114   335    42    84    23     1     6
 7 aguilje01   2018     1 MIL    NL      149   492    80   135    25     0    35
 8 ahmedni01   2018     1 ARI    NL      153   516    61   121    33     5    16
 9 albieoz01   2018     1 ATL    NL      158   639   105   167    40     5    24
10 alexasc01   2018     1 LAN    NL       73     5     0     0     0     0     0
# i 508 more rows
# i 10 more variables: RBI &lt;int&gt;, SB &lt;int&gt;, CS &lt;int&gt;, BB &lt;int&gt;, SO &lt;int&gt;,
#   IBB &lt;int&gt;, HBP &lt;int&gt;, SH &lt;int&gt;, SF &lt;int&gt;, GIDP &lt;int&gt;</code></pre>
</div>
</div>
<ul>
<li>Often we want to check if a variable is in a specific group of values. We might think this is the way:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">#wrong!</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>batting_tbl <span class="sc">|&gt;</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(G <span class="sc">&gt;</span> <span class="dv">50</span>, yearID <span class="sc">==</span> <span class="fu">c</span>(<span class="dv">2018</span>, <span class="dv">2019</span>, <span class="dv">2020</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 408 x 22
   playerID  yearID stint teamID lgID      G    AB     R     H   X2B   X3B    HR
   &lt;chr&gt;      &lt;int&gt; &lt;int&gt; &lt;fct&gt;  &lt;fct&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
 1 abreujo02   2018     1 CHA    AL      128   499    68   132    36     1    22
 2 adducji02   2018     1 DET    AL       59   176    19    47     8     2     3
 3 ahmedni01   2018     1 ARI    NL      153   516    61   121    33     5    16
 4 albieoz01   2018     1 ATL    NL      158   639   105   167    40     5    24
 5 alexasc01   2018     1 LAN    NL       73     5     0     0     0     0     0
 6 almoral01   2018     1 CHN    NL      152   444    62   127    24     1     5
 7 altheaa01   2018     1 PHI    NL      105   243    28    44    11     1     8
 8 alvarjo03   2018     1 TBA    AL       70     0     0     0     0     0     0
 9 anderbr06   2018     1 MIA    NL      156   590    87   161    34     4    11
10 anderju01   2018     1 LAA    AL       57     0     0     0     0     0     0
# i 398 more rows
# i 10 more variables: RBI &lt;int&gt;, SB &lt;int&gt;, CS &lt;int&gt;, BB &lt;int&gt;, SO &lt;int&gt;,
#   IBB &lt;int&gt;, HBP &lt;int&gt;, SH &lt;int&gt;, SF &lt;int&gt;, GIDP &lt;int&gt;</code></pre>
</div>
</div>
<ul>
<li>Here, R uses <em>recycling</em> on the vector and actually compares the 1st element to 2018, the 2nd to 2019, the third to 2020, the fourth to 2018, the fifth to 2019, …</li>
<li>Use <code>%in%</code> to choose any observations matching an element of a vector</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>batting_tbl <span class="sc">|&gt;</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(G <span class="sc">&gt;</span> <span class="dv">50</span>, yearID <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2018</span>, <span class="dv">2019</span>, <span class="dv">2020</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,172 x 22
   playerID  yearID stint teamID lgID      G    AB     R     H   X2B   X3B    HR
   &lt;chr&gt;      &lt;int&gt; &lt;int&gt; &lt;fct&gt;  &lt;fct&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
 1 abreujo02   2018     1 CHA    AL      128   499    68   132    36     1    22
 2 acunaro01   2018     1 ATL    NL      111   433    78   127    26     4    26
 3 adamewi01   2018     1 TBA    AL       85   288    43    80     7     0    10
 4 adamsma01   2018     1 WAS    NL       94   249    37    64     9     0    18
 5 adducji02   2018     1 DET    AL       59   176    19    47     8     2     3
 6 adriaeh01   2018     1 MIN    AL      114   335    42    84    23     1     6
 7 aguilje01   2018     1 MIL    NL      149   492    80   135    25     0    35
 8 ahmedni01   2018     1 ARI    NL      153   516    61   121    33     5    16
 9 albieoz01   2018     1 ATL    NL      158   639   105   167    40     5    24
10 alexasc01   2018     1 LAN    NL       73     5     0     0     0     0     0
# i 1,162 more rows
# i 10 more variables: RBI &lt;int&gt;, SB &lt;int&gt;, CS &lt;int&gt;, BB &lt;int&gt;, SO &lt;int&gt;,
#   IBB &lt;int&gt;, HBP &lt;int&gt;, SH &lt;int&gt;, SF &lt;int&gt;, GIDP &lt;int&gt;</code></pre>
</div>
</div>
<ul>
<li><p>If we want an <em>or</em> condition, we use the compound logical operator for that</p>
<ul>
<li>Here, grab those with either games greater than 50 or those that played in 2018, 2019, or 2020 (or both)</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>batting_tbl <span class="sc">|&gt;</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(G <span class="sc">&gt;</span> <span class="dv">50</span> <span class="sc">|</span> yearID <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2018</span>, <span class="dv">2019</span>, <span class="dv">2020</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 43,460 x 22
   playerID  yearID stint teamID lgID      G    AB     R     H   X2B   X3B    HR
   &lt;chr&gt;      &lt;int&gt; &lt;int&gt; &lt;fct&gt;  &lt;fct&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
 1 bechtge01   1872     1 NY2    NA       51   247    61    74    11     3     0
 2 cummica01   1872     1 NY2    NA       55   249    37    52     9     3     0
 3 eggleda01   1872     1 NY2    NA       56   290    94    97    20     0     0
 4 hallge01    1872     1 BL1    NA       53   250    69    84    17     6     1
 5 hatfijo01   1872     1 NY2    NA       56   288    76    93    15     2     1
 6 hicksna01   1872     1 NY2    NA       56   267    54    82    12     2     0
 7 mcmuljo01   1872     1 NY2    NA       54   236    47    60     6     1     0
 8 millsev01   1872     1 BL1    NA       55   266    55    79    14     2     0
 9 pikeli01    1872     1 BL1    NA       56   285    68    85    15     5     7
10 radcljo01   1872     1 BL1    NA       56   297    70    86    13     4     1
# i 43,450 more rows
# i 10 more variables: RBI &lt;int&gt;, SB &lt;int&gt;, CS &lt;int&gt;, BB &lt;int&gt;, SO &lt;int&gt;,
#   IBB &lt;int&gt;, HBP &lt;int&gt;, SH &lt;int&gt;, SF &lt;int&gt;, GIDP &lt;int&gt;</code></pre>
</div>
</div>
<ul>
<li>Again, note the change in the observation count!</li>
</ul>
</section>
<section id="arrange" class="level3">
<h3 class="anchored" data-anchor-id="arrange"><code>arrange()</code></h3>
<p>The other major observation (row) manipulation is to reorder the observations (rows). This is done through <code>arrange()</code> from <code>dplyr</code> (or <code>sort()</code> in <code>BaseR</code>)</p>
<ul>
<li>Let’s take our result from above and reorder by <code>teamID</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>batting_tbl <span class="sc">|&gt;</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(G <span class="sc">&gt;</span> <span class="dv">50</span>, yearID <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2018</span>, <span class="dv">2019</span>, <span class="dv">2020</span>)) <span class="sc">|&gt;</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(teamID)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,172 x 22
   playerID  yearID stint teamID lgID      G    AB     R     H   X2B   X3B    HR
   &lt;chr&gt;      &lt;int&gt; &lt;int&gt; &lt;fct&gt;  &lt;fct&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
 1 ahmedni01   2018     1 ARI    NL      153   516    61   121    33     5    16
 2 avilaal01   2018     1 ARI    NL       80   194    13    32     6     0     7
 3 boxbebr01   2018     1 ARI    NL       60     0     0     0     0     0     0
 4 bradlar01   2018     1 ARI    NL       76     0     0     0     0     0     0
 5 chafian01   2018     1 ARI    NL       77     0     0     0     0     0     0
 6 descada01   2018     1 ARI    NL      138   349    54    83    22     4    13
 7 dysonja01   2018     1 ARI    NL       67   206    29    39     4     2     2
 8 escobed01   2018     2 ARI    NL       54   198    30    53    11     0     8
 9 goldspa01   2018     1 ARI    NL      158   593    95   172    35     5    33
10 hiranyo01   2018     1 ARI    NL       75     1     0     0     0     0     0
# i 1,162 more rows
# i 10 more variables: RBI &lt;int&gt;, SB &lt;int&gt;, CS &lt;int&gt;, BB &lt;int&gt;, SO &lt;int&gt;,
#   IBB &lt;int&gt;, HBP &lt;int&gt;, SH &lt;int&gt;, SF &lt;int&gt;, GIDP &lt;int&gt;</code></pre>
</div>
</div>
<ul>
<li><p>Remember to read the pipe (<code>|&gt;</code>) as ‘then’. Here we would say:</p>
<ul>
<li><p>Take the batting tibble and then</p></li>
<li><p>filter the rows to only include those with games greater than 50 and those that played in 2018-2020 and then</p></li>
<li><p>arrange the rows by the team name</p></li>
</ul></li>
<li><p>We can obtain a secondary arrangement by giving a second column</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>batting_tbl <span class="sc">|&gt;</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(G <span class="sc">&gt;</span> <span class="dv">50</span>, yearID <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2018</span>, <span class="dv">2019</span>, <span class="dv">2020</span>)) <span class="sc">|&gt;</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(teamID, playerID)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,172 x 22
   playerID  yearID stint teamID lgID      G    AB     R     H   X2B   X3B    HR
   &lt;chr&gt;      &lt;int&gt; &lt;int&gt; &lt;fct&gt;  &lt;fct&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
 1 ahmedni01   2018     1 ARI    NL      153   516    61   121    33     5    16
 2 ahmedni01   2019     1 ARI    NL      158   556    79   141    33     6    19
 3 ahmedni01   2020     1 ARI    NL       57   199    29    53    10     1     5
 4 andrima01   2019     1 ARI    NL       54     6     0     0     0     0     0
 5 avilaal01   2018     1 ARI    NL       80   194    13    32     6     0     7
 6 avilaal01   2019     1 ARI    NL       63   164    22    34     8     0     9
 7 boxbebr01   2018     1 ARI    NL       60     0     0     0     0     0     0
 8 bradlar01   2018     1 ARI    NL       76     0     0     0     0     0     0
 9 bradlar01   2019     1 ARI    NL       66     1     0     0     0     0     0
10 calhoko01   2020     1 ARI    NL       54   190    35    43     9     0    16
# i 1,162 more rows
# i 10 more variables: RBI &lt;int&gt;, SB &lt;int&gt;, CS &lt;int&gt;, BB &lt;int&gt;, SO &lt;int&gt;,
#   IBB &lt;int&gt;, HBP &lt;int&gt;, SH &lt;int&gt;, SF &lt;int&gt;, GIDP &lt;int&gt;</code></pre>
</div>
</div>
<ul>
<li>We can reorder descending on a variable</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>batting_tbl <span class="sc">|&gt;</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(G <span class="sc">&gt;</span> <span class="dv">50</span>, yearID <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2018</span>, <span class="dv">2019</span>, <span class="dv">2020</span>)) <span class="sc">|&gt;</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(teamID), playerID)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,172 x 22
   playerID  yearID stint teamID lgID      G    AB     R     H   X2B   X3B    HR
   &lt;chr&gt;      &lt;int&gt; &lt;int&gt; &lt;fct&gt;  &lt;fct&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
 1 adamsma01   2018     1 WAS    NL       94   249    37    64     9     0    18
 2 adamsma01   2019     1 WAS    NL      111   310    42    70    14     0    20
 3 cabreas01   2020     1 WAS    NL       52   190    23    46     9     3     8
 4 difowi01    2018     1 WAS    NL      148   408    55    94    14     7     7
 5 doolise01   2019     1 WAS    NL       63     3     0     0     0     0     0
 6 doziebr01   2019     1 WAS    NL      135   416    54    99    20     0    20
 7 eatonad02   2018     1 WAS    NL       95   319    55    96    18     1     5
 8 eatonad02   2019     1 WAS    NL      151   566   103   158    25     7    15
 9 gomesya01   2019     1 WAS    NL       97   314    36    70    16     0    12
10 gracema02   2018     1 WAS    NL       56     3     0     1     0     0     0
# i 1,162 more rows
# i 10 more variables: RBI &lt;int&gt;, SB &lt;int&gt;, CS &lt;int&gt;, BB &lt;int&gt;, SO &lt;int&gt;,
#   IBB &lt;int&gt;, HBP &lt;int&gt;, SH &lt;int&gt;, SF &lt;int&gt;, GIDP &lt;int&gt;</code></pre>
</div>
</div>
</section>
</section>
<section id="column-manipulations-with-dplyr" class="level2">
<h2 class="anchored" data-anchor-id="column-manipulations-with-dplyr">Column Manipulations with <code>dplyr</code></h2>
<p>We may want to subset our variables, rename them, or create new variables.</p>
<section id="select---subset-columns" class="level3">
<h3 class="anchored" data-anchor-id="select---subset-columns"><code>select()</code> - Subset Columns</h3>
<p>We call the subset of our variables <strong>selecting</strong> columns (or variables)</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/selectVisualF.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="400"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p>To return a single (probably simplified) column we looked at the following methods (one of which is in the <code>tidyverse</code>):</p>
<ul>
<li><code>dplyr::pull()</code></li>
<li><code>$</code></li>
<li><code>[ , ]</code></li>
</ul></li>
</ul>
<p>When we want to look at pulling more than one column, <code>select()</code> is much better!</p>
<ul>
<li><p>Suppose we just wanted to look at the <code>playerID</code>, <code>teamID</code>, and hits type variables: <code>H</code>, <code>X2B</code> <code>X3B</code>, and <code>HR</code> of the players in our subset</p></li>
<li><p>We can add in a <code>select()</code> function to our chain (thanks again coherent ecosystem!).</p>
<ul>
<li>One way is to simply list the columns you want:</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>batting_tbl <span class="sc">|&gt;</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(G <span class="sc">&gt;</span> <span class="dv">50</span>, yearID <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2018</span>, <span class="dv">2019</span>, <span class="dv">2020</span>)) <span class="sc">|&gt;</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(teamID), playerID) <span class="sc">|&gt;</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(playerID, teamID, H, X2B, X3B, HR)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,172 x 6
   playerID  teamID     H   X2B   X3B    HR
   &lt;chr&gt;     &lt;fct&gt;  &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
 1 adamsma01 WAS       64     9     0    18
 2 adamsma01 WAS       70    14     0    20
 3 cabreas01 WAS       46     9     3     8
 4 difowi01  WAS       94    14     7     7
 5 doolise01 WAS        0     0     0     0
 6 doziebr01 WAS       99    20     0    20
 7 eatonad02 WAS       96    18     1     5
 8 eatonad02 WAS      158    25     7    15
 9 gomesya01 WAS       70    16     0    12
10 gracema02 WAS        1     0     0     0
# i 1,162 more rows</code></pre>
</div>
</div>
<ul>
<li><p>Where we really gain here is the ability to use helper functions when selecting columns!</p>
<ul>
<li><code>:</code> to select all contiguous columns</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>batting_tbl <span class="sc">|&gt;</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(G <span class="sc">&gt;</span> <span class="dv">50</span>, yearID <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2018</span>, <span class="dv">2019</span>, <span class="dv">2020</span>)) <span class="sc">|&gt;</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(teamID), playerID) <span class="sc">|&gt;</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(playerID, teamID, H<span class="sc">:</span>HR)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,172 x 6
   playerID  teamID     H   X2B   X3B    HR
   &lt;chr&gt;     &lt;fct&gt;  &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
 1 adamsma01 WAS       64     9     0    18
 2 adamsma01 WAS       70    14     0    20
 3 cabreas01 WAS       46     9     3     8
 4 difowi01  WAS       94    14     7     7
 5 doolise01 WAS        0     0     0     0
 6 doziebr01 WAS       99    20     0    20
 7 eatonad02 WAS       96    18     1     5
 8 eatonad02 WAS      158    25     7    15
 9 gomesya01 WAS       70    16     0    12
10 gracema02 WAS        1     0     0     0
# i 1,162 more rows</code></pre>
</div>
</div>
<ul>
<li><code>starts_with()</code> and <code>ends_with()</code> are also really useful</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>batting_tbl <span class="sc">|&gt;</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(G <span class="sc">&gt;</span> <span class="dv">50</span>, yearID <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2018</span>, <span class="dv">2019</span>, <span class="dv">2020</span>)) <span class="sc">|&gt;</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(teamID), playerID) <span class="sc">|&gt;</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">ends_with</span>(<span class="st">"ID"</span>), G, AB, H<span class="sc">:</span>HR)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,172 x 10
   playerID  yearID teamID lgID      G    AB     H   X2B   X3B    HR
   &lt;chr&gt;      &lt;int&gt; &lt;fct&gt;  &lt;fct&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
 1 adamsma01   2018 WAS    NL       94   249    64     9     0    18
 2 adamsma01   2019 WAS    NL      111   310    70    14     0    20
 3 cabreas01   2020 WAS    NL       52   190    46     9     3     8
 4 difowi01    2018 WAS    NL      148   408    94    14     7     7
 5 doolise01   2019 WAS    NL       63     3     0     0     0     0
 6 doziebr01   2019 WAS    NL      135   416    99    20     0    20
 7 eatonad02   2018 WAS    NL       95   319    96    18     1     5
 8 eatonad02   2019 WAS    NL      151   566   158    25     7    15
 9 gomesya01   2019 WAS    NL       97   314    70    16     0    12
10 gracema02   2018 WAS    NL       56     3     1     0     0     0
# i 1,162 more rows</code></pre>
</div>
</div>
<ul>
<li>We can combine those two as well using <code>&amp;</code> and <code>|</code> operators</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>batting_tbl <span class="sc">|&gt;</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(G <span class="sc">&gt;</span> <span class="dv">50</span>, yearID <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2018</span>, <span class="dv">2019</span>, <span class="dv">2020</span>)) <span class="sc">|&gt;</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(teamID), playerID) <span class="sc">|&gt;</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">ends_with</span>(<span class="st">"ID"</span>) <span class="sc">|</span> <span class="fu">starts_with</span>(<span class="st">"X"</span>), G, AB, H, HR)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,172 x 10
   playerID  yearID teamID lgID    X2B   X3B     G    AB     H    HR
   &lt;chr&gt;      &lt;int&gt; &lt;fct&gt;  &lt;fct&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
 1 adamsma01   2018 WAS    NL        9     0    94   249    64    18
 2 adamsma01   2019 WAS    NL       14     0   111   310    70    20
 3 cabreas01   2020 WAS    NL        9     3    52   190    46     8
 4 difowi01    2018 WAS    NL       14     7   148   408    94     7
 5 doolise01   2019 WAS    NL        0     0    63     3     0     0
 6 doziebr01   2019 WAS    NL       20     0   135   416    99    20
 7 eatonad02   2018 WAS    NL       18     1    95   319    96     5
 8 eatonad02   2019 WAS    NL       25     7   151   566   158    15
 9 gomesya01   2019 WAS    NL       16     0    97   314    70    12
10 gracema02   2018 WAS    NL        0     0    56     3     1     0
# i 1,162 more rows</code></pre>
</div>
</div>
<ul>
<li>If our goal is really just to reorder the columns, we can use <code>everything()</code> after specifying the columns of interest</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>batting_tbl <span class="sc">|&gt;</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(G <span class="sc">&gt;</span> <span class="dv">50</span>, yearID <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2018</span>, <span class="dv">2019</span>, <span class="dv">2020</span>)) <span class="sc">|&gt;</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(teamID), playerID) <span class="sc">|&gt;</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(playerID, H<span class="sc">:</span>HR, <span class="fu">everything</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,172 x 22
   playerID      H   X2B   X3B    HR yearID stint teamID lgID      G    AB     R
   &lt;chr&gt;     &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;  &lt;int&gt; &lt;int&gt; &lt;fct&gt;  &lt;fct&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
 1 adamsma01    64     9     0    18   2018     1 WAS    NL       94   249    37
 2 adamsma01    70    14     0    20   2019     1 WAS    NL      111   310    42
 3 cabreas01    46     9     3     8   2020     1 WAS    NL       52   190    23
 4 difowi01     94    14     7     7   2018     1 WAS    NL      148   408    55
 5 doolise01     0     0     0     0   2019     1 WAS    NL       63     3     0
 6 doziebr01    99    20     0    20   2019     1 WAS    NL      135   416    54
 7 eatonad02    96    18     1     5   2018     1 WAS    NL       95   319    55
 8 eatonad02   158    25     7    15   2019     1 WAS    NL      151   566   103
 9 gomesya01    70    16     0    12   2019     1 WAS    NL       97   314    36
10 gracema02     1     0     0     0   2018     1 WAS    NL       56     3     0
# i 1,162 more rows
# i 10 more variables: RBI &lt;int&gt;, SB &lt;int&gt;, CS &lt;int&gt;, BB &lt;int&gt;, SO &lt;int&gt;,
#   IBB &lt;int&gt;, HBP &lt;int&gt;, SH &lt;int&gt;, SF &lt;int&gt;, GIDP &lt;int&gt;</code></pre>
</div>
</div>
<ul>
<li>See the help for <code>select()</code> for more information about selection features (<strong>these can usually be used in any <code>tidyverse</code> functions where you are selecting columns!</strong>)</li>
</ul>
</section>
<section id="rename" class="level3">
<h3 class="anchored" data-anchor-id="rename"><code>rename()</code></h3>
<p>We’ve seen the use of <code>colnames()</code> or <code>names()</code> to rename columns. Those are great but aren’t easy to chain. <code>rename()</code> comes in handy in this case!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>batting_tbl <span class="sc">|&gt;</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(G <span class="sc">&gt;</span> <span class="dv">50</span>, yearID <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2018</span>, <span class="dv">2019</span>, <span class="dv">2020</span>)) <span class="sc">|&gt;</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(teamID), playerID) <span class="sc">|&gt;</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(playerID, teamID, H<span class="sc">:</span>HR) <span class="sc">|&gt;</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Doubles"</span> <span class="ot">=</span> <span class="st">"X2B"</span>, <span class="st">"Triples"</span> <span class="ot">=</span> <span class="st">"X3B"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,172 x 6
   playerID  teamID     H Doubles Triples    HR
   &lt;chr&gt;     &lt;fct&gt;  &lt;int&gt;   &lt;int&gt;   &lt;int&gt; &lt;int&gt;
 1 adamsma01 WAS       64       9       0    18
 2 adamsma01 WAS       70      14       0    20
 3 cabreas01 WAS       46       9       3     8
 4 difowi01  WAS       94      14       7     7
 5 doolise01 WAS        0       0       0     0
 6 doziebr01 WAS       99      20       0    20
 7 eatonad02 WAS       96      18       1     5
 8 eatonad02 WAS      158      25       7    15
 9 gomesya01 WAS       70      16       0    12
10 gracema02 WAS        1       0       0     0
# i 1,162 more rows</code></pre>
</div>
</div>
</section>
<section id="creating-new-variables-with-dplyr" class="level3">
<h3 class="anchored" data-anchor-id="creating-new-variables-with-dplyr">Creating New Variables with <code>dplyr</code></h3>
<p>Often we want to create new variables!</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/createVarVisualF.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="500"></p>
</figure>
</div>
</div>
</div>
<p>This can be accomplished using <code>mutate()</code>. This function allows us to create one or more variables and append them to our tibble.</p>
<ul>
<li>For our dataset from above, suppose we wanted to create an “extra base hits” type column that is the sum of the doubles, triples, and home runs.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>batting_tbl <span class="sc">|&gt;</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(G <span class="sc">&gt;</span> <span class="dv">50</span>, yearID <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2018</span>, <span class="dv">2019</span>, <span class="dv">2020</span>)) <span class="sc">|&gt;</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(teamID), playerID) <span class="sc">|&gt;</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(playerID, teamID, H<span class="sc">:</span>HR) <span class="sc">|&gt;</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Doubles"</span> <span class="ot">=</span> <span class="st">"X2B"</span>, <span class="st">"Triples"</span> <span class="ot">=</span> <span class="st">"X3B"</span>) <span class="sc">|&gt;</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Extra_Base_Hits =</span> Doubles <span class="sc">+</span> Triples <span class="sc">+</span> HR)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,172 x 7
   playerID  teamID     H Doubles Triples    HR Extra_Base_Hits
   &lt;chr&gt;     &lt;fct&gt;  &lt;int&gt;   &lt;int&gt;   &lt;int&gt; &lt;int&gt;           &lt;int&gt;
 1 adamsma01 WAS       64       9       0    18              27
 2 adamsma01 WAS       70      14       0    20              34
 3 cabreas01 WAS       46       9       3     8              20
 4 difowi01  WAS       94      14       7     7              28
 5 doolise01 WAS        0       0       0     0               0
 6 doziebr01 WAS       99      20       0    20              40
 7 eatonad02 WAS       96      18       1     5              24
 8 eatonad02 WAS      158      25       7    15              47
 9 gomesya01 WAS       70      16       0    12              28
10 gracema02 WAS        1       0       0     0               0
# i 1,162 more rows</code></pre>
</div>
</div>
<ul>
<li><p>If we want to add more than one variable, we just separate the variable definitions with a comma.</p>
<ul>
<li>Let’s add a <code>Singles</code> variable representing the number of hits minus the number of extra base hits</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>batting_tbl <span class="sc">|&gt;</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(G <span class="sc">&gt;</span> <span class="dv">50</span>, yearID <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2018</span>, <span class="dv">2019</span>, <span class="dv">2020</span>)) <span class="sc">|&gt;</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(teamID), playerID) <span class="sc">|&gt;</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(playerID, teamID, H<span class="sc">:</span>HR) <span class="sc">|&gt;</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Doubles"</span> <span class="ot">=</span> <span class="st">"X2B"</span>, <span class="st">"Triples"</span> <span class="ot">=</span> <span class="st">"X3B"</span>) <span class="sc">|&gt;</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Extra_Base_Hits =</span> Doubles <span class="sc">+</span> Triples <span class="sc">+</span> HR,</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">Singles =</span> H <span class="sc">-</span> Extra_Base_Hits) <span class="sc">|&gt;</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(playerID, teamID, Singles, Doubles<span class="sc">:</span>HR, H, Extra_Base_Hits)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,172 x 8
   playerID  teamID Singles Doubles Triples    HR     H Extra_Base_Hits
   &lt;chr&gt;     &lt;fct&gt;    &lt;int&gt;   &lt;int&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt;           &lt;int&gt;
 1 adamsma01 WAS         37       9       0    18    64              27
 2 adamsma01 WAS         36      14       0    20    70              34
 3 cabreas01 WAS         26       9       3     8    46              20
 4 difowi01  WAS         66      14       7     7    94              28
 5 doolise01 WAS          0       0       0     0     0               0
 6 doziebr01 WAS         59      20       0    20    99              40
 7 eatonad02 WAS         72      18       1     5    96              24
 8 eatonad02 WAS        111      25       7    15   158              47
 9 gomesya01 WAS         42      16       0    12    70              28
10 gracema02 WAS          1       0       0     0     1               0
# i 1,162 more rows</code></pre>
</div>
</div>
<ul>
<li><p>We can of course use lots of functions when creating a new variable as well. Some common functions are <code>log()</code>, <code>lead()</code>, <code>lag()</code>, <code>percent_rank()</code>, <code>cumsum()</code>, etc. (see the help for <code>mutate</code> for a nice list).</p>
<ul>
<li>Let’s use <code>percent_rank()</code> to get a new column telling us where they rank for number of hits</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>batting_tbl <span class="sc">|&gt;</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(G <span class="sc">&gt;</span> <span class="dv">50</span>, yearID <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2018</span>, <span class="dv">2019</span>, <span class="dv">2020</span>)) <span class="sc">|&gt;</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(teamID), playerID) <span class="sc">|&gt;</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(playerID, teamID, H<span class="sc">:</span>HR) <span class="sc">|&gt;</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Doubles"</span> <span class="ot">=</span> <span class="st">"X2B"</span>, <span class="st">"Triples"</span> <span class="ot">=</span> <span class="st">"X3B"</span>) <span class="sc">|&gt;</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Extra_Base_Hits =</span> Doubles <span class="sc">+</span> Triples <span class="sc">+</span> HR,</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">Singles =</span> H <span class="sc">-</span> Extra_Base_Hits,</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">H_Percentile =</span> <span class="fu">percent_rank</span>(H)) <span class="sc">|&gt;</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(playerID, teamID, H, H_Percentile, <span class="fu">everything</span>()) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,172 x 9
   playerID  teamID     H H_Percentile Doubles Triples    HR Extra_Base_Hits
   &lt;chr&gt;     &lt;fct&gt;  &lt;int&gt;        &lt;dbl&gt;   &lt;int&gt;   &lt;int&gt; &lt;int&gt;           &lt;int&gt;
 1 adamsma01 WAS       64        0.512       9       0    18              27
 2 adamsma01 WAS       70        0.546      14       0    20              34
 3 cabreas01 WAS       46        0.352       9       3     8              20
 4 difowi01  WAS       94        0.675      14       7     7              28
 5 doolise01 WAS        0        0           0       0     0               0
 6 doziebr01 WAS       99        0.698      20       0    20              40
 7 eatonad02 WAS       96        0.686      18       1     5              24
 8 eatonad02 WAS      158        0.933      25       7    15              47
 9 gomesya01 WAS       70        0.546      16       0    12              28
10 gracema02 WAS        1        0.194       0       0     0               0
# i 1,162 more rows
# i 1 more variable: Singles &lt;int&gt;</code></pre>
</div>
</div>
<ul>
<li>A common comparison we want to do is to take a particular value and compare it to its mean. Let’s add in a mean variable for hits as well.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>batting_tbl <span class="sc">|&gt;</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(G <span class="sc">&gt;</span> <span class="dv">50</span>, yearID <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2018</span>, <span class="dv">2019</span>, <span class="dv">2020</span>)) <span class="sc">|&gt;</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(teamID), playerID) <span class="sc">|&gt;</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(playerID, teamID, H<span class="sc">:</span>HR) <span class="sc">|&gt;</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Doubles"</span> <span class="ot">=</span> <span class="st">"X2B"</span>, <span class="st">"Triples"</span> <span class="ot">=</span> <span class="st">"X3B"</span>) <span class="sc">|&gt;</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Extra_Base_Hits =</span> Doubles <span class="sc">+</span> Triples <span class="sc">+</span> HR,</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">Singles =</span> H <span class="sc">-</span> Extra_Base_Hits,</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">H_Percentile =</span> <span class="fu">percent_rank</span>(H),</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">H_Mean =</span> <span class="fu">mean</span>(H)) <span class="sc">|&gt;</span></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(playerID, teamID, H, H_Mean, H_Percentile, <span class="fu">everything</span>()) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,172 x 10
   playerID  teamID     H H_Mean H_Percentile Doubles Triples    HR
   &lt;chr&gt;     &lt;fct&gt;  &lt;int&gt;  &lt;dbl&gt;        &lt;dbl&gt;   &lt;int&gt;   &lt;int&gt; &lt;int&gt;
 1 adamsma01 WAS       64   69.7        0.512       9       0    18
 2 adamsma01 WAS       70   69.7        0.546      14       0    20
 3 cabreas01 WAS       46   69.7        0.352       9       3     8
 4 difowi01  WAS       94   69.7        0.675      14       7     7
 5 doolise01 WAS        0   69.7        0           0       0     0
 6 doziebr01 WAS       99   69.7        0.698      20       0    20
 7 eatonad02 WAS       96   69.7        0.686      18       1     5
 8 eatonad02 WAS      158   69.7        0.933      25       7    15
 9 gomesya01 WAS       70   69.7        0.546      16       0    12
10 gracema02 WAS        1   69.7        0.194       0       0     0
# i 1,162 more rows
# i 2 more variables: Extra_Base_Hits &lt;int&gt;, Singles &lt;int&gt;</code></pre>
</div>
</div>
<ul>
<li><p>Useful, but what if we want to show the mean by team? Easy to do in <code>dplyr</code> using <code>group_by()</code>!</p></li>
<li><p>If we add <code>group_by()</code> in our chain, any summary statistics created will honor those groups (<code>ungroup()</code> exists if you want to remove a grouping).</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>batting_tbl <span class="sc">|&gt;</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(G <span class="sc">&gt;</span> <span class="dv">50</span>, yearID <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2018</span>, <span class="dv">2019</span>, <span class="dv">2020</span>)) <span class="sc">|&gt;</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(teamID), playerID) <span class="sc">|&gt;</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(playerID, teamID, H<span class="sc">:</span>HR) <span class="sc">|&gt;</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Doubles"</span> <span class="ot">=</span> <span class="st">"X2B"</span>, <span class="st">"Triples"</span> <span class="ot">=</span> <span class="st">"X3B"</span>) <span class="sc">|&gt;</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(teamID)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,172 x 6
# Groups:   teamID [30]
   playerID  teamID     H Doubles Triples    HR
   &lt;chr&gt;     &lt;fct&gt;  &lt;int&gt;   &lt;int&gt;   &lt;int&gt; &lt;int&gt;
 1 adamsma01 WAS       64       9       0    18
 2 adamsma01 WAS       70      14       0    20
 3 cabreas01 WAS       46       9       3     8
 4 difowi01  WAS       94      14       7     7
 5 doolise01 WAS        0       0       0     0
 6 doziebr01 WAS       99      20       0    20
 7 eatonad02 WAS       96      18       1     5
 8 eatonad02 WAS      158      25       7    15
 9 gomesya01 WAS       70      16       0    12
10 gracema02 WAS        1       0       0     0
# i 1,162 more rows</code></pre>
</div>
</div>
<ul>
<li>Notice there is now an additional attribute associated with this <code>tibble</code>!</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>batting_tbl <span class="sc">|&gt;</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(G <span class="sc">&gt;</span> <span class="dv">50</span>, yearID <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2018</span>, <span class="dv">2019</span>, <span class="dv">2020</span>)) <span class="sc">|&gt;</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(teamID), playerID) <span class="sc">|&gt;</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(playerID, teamID, H<span class="sc">:</span>HR) <span class="sc">|&gt;</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Doubles"</span> <span class="ot">=</span> <span class="st">"X2B"</span>, <span class="st">"Triples"</span> <span class="ot">=</span> <span class="st">"X3B"</span>) <span class="sc">|&gt;</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(teamID) <span class="sc">|&gt;</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">attributes</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$class
[1] "grouped_df" "tbl_df"     "tbl"        "data.frame"

$row.names
   [1]    1    2    3    4    5    6    7    8    9   10   11   12   13   14
  [15]   15   16   17   18   19   20   21   22   23   24   25   26   27   28
  [29]   29   30   31   32   33   34   35   36   37   38   39   40   41   42
  [43]   43   44   45   46   47   48   49   50   51   52   53   54   55   56
  [57]   57   58   59   60   61   62   63   64   65   66   67   68   69   70
  [71]   71   72   73   74   75   76   77   78   79   80   81   82   83   84
  [85]   85   86   87   88   89   90   91   92   93   94   95   96   97   98
  [99]   99  100  101  102  103  104  105  106  107  108  109  110  111  112
 [113]  113  114  115  116  117  118  119  120  121  122  123  124  125  126
 [127]  127  128  129  130  131  132  133  134  135  136  137  138  139  140
 [141]  141  142  143  144  145  146  147  148  149  150  151  152  153  154
 [155]  155  156  157  158  159  160  161  162  163  164  165  166  167  168
 [169]  169  170  171  172  173  174  175  176  177  178  179  180  181  182
 [183]  183  184  185  186  187  188  189  190  191  192  193  194  195  196
 [197]  197  198  199  200  201  202  203  204  205  206  207  208  209  210
 [211]  211  212  213  214  215  216  217  218  219  220  221  222  223  224
 [225]  225  226  227  228  229  230  231  232  233  234  235  236  237  238
 [239]  239  240  241  242  243  244  245  246  247  248  249  250  251  252
 [253]  253  254  255  256  257  258  259  260  261  262  263  264  265  266
 [267]  267  268  269  270  271  272  273  274  275  276  277  278  279  280
 [281]  281  282  283  284  285  286  287  288  289  290  291  292  293  294
 [295]  295  296  297  298  299  300  301  302  303  304  305  306  307  308
 [309]  309  310  311  312  313  314  315  316  317  318  319  320  321  322
 [323]  323  324  325  326  327  328  329  330  331  332  333  334  335  336
 [337]  337  338  339  340  341  342  343  344  345  346  347  348  349  350
 [351]  351  352  353  354  355  356  357  358  359  360  361  362  363  364
 [365]  365  366  367  368  369  370  371  372  373  374  375  376  377  378
 [379]  379  380  381  382  383  384  385  386  387  388  389  390  391  392
 [393]  393  394  395  396  397  398  399  400  401  402  403  404  405  406
 [407]  407  408  409  410  411  412  413  414  415  416  417  418  419  420
 [421]  421  422  423  424  425  426  427  428  429  430  431  432  433  434
 [435]  435  436  437  438  439  440  441  442  443  444  445  446  447  448
 [449]  449  450  451  452  453  454  455  456  457  458  459  460  461  462
 [463]  463  464  465  466  467  468  469  470  471  472  473  474  475  476
 [477]  477  478  479  480  481  482  483  484  485  486  487  488  489  490
 [491]  491  492  493  494  495  496  497  498  499  500  501  502  503  504
 [505]  505  506  507  508  509  510  511  512  513  514  515  516  517  518
 [519]  519  520  521  522  523  524  525  526  527  528  529  530  531  532
 [533]  533  534  535  536  537  538  539  540  541  542  543  544  545  546
 [547]  547  548  549  550  551  552  553  554  555  556  557  558  559  560
 [561]  561  562  563  564  565  566  567  568  569  570  571  572  573  574
 [575]  575  576  577  578  579  580  581  582  583  584  585  586  587  588
 [589]  589  590  591  592  593  594  595  596  597  598  599  600  601  602
 [603]  603  604  605  606  607  608  609  610  611  612  613  614  615  616
 [617]  617  618  619  620  621  622  623  624  625  626  627  628  629  630
 [631]  631  632  633  634  635  636  637  638  639  640  641  642  643  644
 [645]  645  646  647  648  649  650  651  652  653  654  655  656  657  658
 [659]  659  660  661  662  663  664  665  666  667  668  669  670  671  672
 [673]  673  674  675  676  677  678  679  680  681  682  683  684  685  686
 [687]  687  688  689  690  691  692  693  694  695  696  697  698  699  700
 [701]  701  702  703  704  705  706  707  708  709  710  711  712  713  714
 [715]  715  716  717  718  719  720  721  722  723  724  725  726  727  728
 [729]  729  730  731  732  733  734  735  736  737  738  739  740  741  742
 [743]  743  744  745  746  747  748  749  750  751  752  753  754  755  756
 [757]  757  758  759  760  761  762  763  764  765  766  767  768  769  770
 [771]  771  772  773  774  775  776  777  778  779  780  781  782  783  784
 [785]  785  786  787  788  789  790  791  792  793  794  795  796  797  798
 [799]  799  800  801  802  803  804  805  806  807  808  809  810  811  812
 [813]  813  814  815  816  817  818  819  820  821  822  823  824  825  826
 [827]  827  828  829  830  831  832  833  834  835  836  837  838  839  840
 [841]  841  842  843  844  845  846  847  848  849  850  851  852  853  854
 [855]  855  856  857  858  859  860  861  862  863  864  865  866  867  868
 [869]  869  870  871  872  873  874  875  876  877  878  879  880  881  882
 [883]  883  884  885  886  887  888  889  890  891  892  893  894  895  896
 [897]  897  898  899  900  901  902  903  904  905  906  907  908  909  910
 [911]  911  912  913  914  915  916  917  918  919  920  921  922  923  924
 [925]  925  926  927  928  929  930  931  932  933  934  935  936  937  938
 [939]  939  940  941  942  943  944  945  946  947  948  949  950  951  952
 [953]  953  954  955  956  957  958  959  960  961  962  963  964  965  966
 [967]  967  968  969  970  971  972  973  974  975  976  977  978  979  980
 [981]  981  982  983  984  985  986  987  988  989  990  991  992  993  994
 [995]  995  996  997  998  999 1000 1001 1002 1003 1004 1005 1006 1007 1008
[1009] 1009 1010 1011 1012 1013 1014 1015 1016 1017 1018 1019 1020 1021 1022
[1023] 1023 1024 1025 1026 1027 1028 1029 1030 1031 1032 1033 1034 1035 1036
[1037] 1037 1038 1039 1040 1041 1042 1043 1044 1045 1046 1047 1048 1049 1050
[1051] 1051 1052 1053 1054 1055 1056 1057 1058 1059 1060 1061 1062 1063 1064
[1065] 1065 1066 1067 1068 1069 1070 1071 1072 1073 1074 1075 1076 1077 1078
[1079] 1079 1080 1081 1082 1083 1084 1085 1086 1087 1088 1089 1090 1091 1092
[1093] 1093 1094 1095 1096 1097 1098 1099 1100 1101 1102 1103 1104 1105 1106
[1107] 1107 1108 1109 1110 1111 1112 1113 1114 1115 1116 1117 1118 1119 1120
[1121] 1121 1122 1123 1124 1125 1126 1127 1128 1129 1130 1131 1132 1133 1134
[1135] 1135 1136 1137 1138 1139 1140 1141 1142 1143 1144 1145 1146 1147 1148
[1149] 1149 1150 1151 1152 1153 1154 1155 1156 1157 1158 1159 1160 1161 1162
[1163] 1163 1164 1165 1166 1167 1168 1169 1170 1171 1172

$names
[1] "playerID" "teamID"   "H"        "Doubles"  "Triples"  "HR"      

$groups
# A tibble: 30 x 2
   teamID       .rows
   &lt;fct&gt;  &lt;list&lt;int&gt;&gt;
 1 ARI           [43]
 2 ATL           [38]
 3 BAL           [39]
 4 BOS           [41]
 5 CHA           [39]
 6 CHN           [38]
 7 CIN           [44]
 8 CLE           [41]
 9 COL           [39]
10 DET           [40]
# i 20 more rows</code></pre>
</div>
</div>
<ul>
<li>Let’s find our mean relative to each team using a <code>group_by()</code> in our chain (this finds the percentile by <code>teamID</code> as well).</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>batting_tbl <span class="sc">|&gt;</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(G <span class="sc">&gt;</span> <span class="dv">50</span>, yearID <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2018</span>, <span class="dv">2019</span>, <span class="dv">2020</span>)) <span class="sc">|&gt;</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(teamID), playerID) <span class="sc">|&gt;</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(playerID, teamID, H<span class="sc">:</span>HR) <span class="sc">|&gt;</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Doubles"</span> <span class="ot">=</span> <span class="st">"X2B"</span>, <span class="st">"Triples"</span> <span class="ot">=</span> <span class="st">"X3B"</span>) <span class="sc">|&gt;</span></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(teamID) <span class="sc">|&gt;</span></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Extra_Base_Hits =</span> Doubles <span class="sc">+</span> Triples <span class="sc">+</span> HR,</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">Singles =</span> H <span class="sc">-</span> Extra_Base_Hits,</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">H_Percentile =</span> <span class="fu">percent_rank</span>(H),</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">H_Mean =</span> <span class="fu">mean</span>(H)) <span class="sc">|&gt;</span></span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(playerID, teamID, H, H_Mean, H_Percentile, <span class="fu">everything</span>()) <span class="sc">|&gt;</span></span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">50</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,172 x 10
# Groups:   teamID [30]
   playerID  teamID     H H_Mean H_Percentile Doubles Triples    HR
   &lt;chr&gt;     &lt;fct&gt;  &lt;int&gt;  &lt;dbl&gt;        &lt;dbl&gt;   &lt;int&gt;   &lt;int&gt; &lt;int&gt;
 1 adamsma01 WAS       64   72.0        0.486       9       0    18
 2 adamsma01 WAS       70   72.0        0.514      14       0    20
 3 cabreas01 WAS       46   72.0        0.351       9       3     8
 4 difowi01  WAS       94   72.0        0.676      14       7     7
 5 doolise01 WAS        0   72.0        0           0       0     0
 6 doziebr01 WAS       99   72.0        0.730      20       0    20
 7 eatonad02 WAS       96   72.0        0.703      18       1     5
 8 eatonad02 WAS      158   72.0        0.919      25       7    15
 9 gomesya01 WAS       70   72.0        0.514      16       0    12
10 gracema02 WAS        1   72.0        0.162       0       0     0
11 gracema02 WAS        0   72.0        0           0       0     0
12 harpebr03 WAS      137   72.0        0.811      34       0    34
13 kendrho01 WAS      115   72.0        0.757      23       1    17
14 kiebosp01 WAS       29   72.0        0.243       5       0     2
15 milleju02 WAS        0   72.0        0           0       0     0
16 murphda08 WAS       57   72.0        0.459       9       0     6
17 parrage01 WAS       47   72.0        0.378      11       1     8
18 raineta01 WAS        0   72.0        0           0       0     0
19 rendoan01 WAS      163   72.0        0.946      44       2    24
20 rendoan01 WAS      174   72.0        0.973      44       3    34
21 reynoma01 WAS       51   72.0        0.405       8       0    13
22 roblevi01 WAS      139   72.0        0.838      33       3    17
23 roblevi01 WAS       37   72.0        0.297       5       1     3
24 severpe01 WAS       32   72.0        0.270       9       0     2
25 solissa01 WAS        0   72.0        0           0       0     0
26 sotoju01  WAS      121   72.0        0.784      25       1    22
27 sotoju01  WAS      153   72.0        0.865      32       5    34
28 stevean01 WAS       19   72.0        0.189       2       0     1
29 suerowa01 WAS        0   72.0        0           0       0     0
30 suzukku01 WAS       74   72.0        0.568      11       0    17
31 taylomi02 WAS       80   72.0        0.649      22       3     6
32 taylomi02 WAS       22   72.0        0.216       7       0     1
33 turnetr01 WAS      180   72.0        1          27       6    19
34 turnetr01 WAS      155   72.0        0.892      37       5    19
35 turnetr01 WAS       78   72.0        0.622      15       4    12
36 wietema01 WAS       56   72.0        0.432       8       0     8
37 zimmery01 WAS       76   72.0        0.595      21       2    13
38 zimmery01 WAS       44   72.0        0.324       9       0     6
39 biggica01 TOR       83   72.9        0.485      17       2    16
40 biggica01 TOR       55   72.9        0.242      16       0     8
41 clippty01 TOR        0   72.9        0           0       0     0
42 diazal02  TOR      111   72.9        0.818      26       0    18
43 drurybr01 TOR       91   72.9        0.667      21       1    15
44 galvifr01 TOR      120   72.9        0.879      24       1    18
45 gavigsa01 TOR        0   72.9        0           0       0     0
46 gileske01 TOR        0   72.9        0           0       0     0
47 grandcu01 TOR       74   72.9        0.455      21       1    11
48 grichra01 TOR      104   72.9        0.758      32       1    25
49 grichra01 TOR      136   72.9        1          29       5    31
50 grichra01 TOR       59   72.9        0.333       9       0    12
# i 1,122 more rows
# i 2 more variables: Extra_Base_Hits &lt;int&gt;, Singles &lt;int&gt;</code></pre>
</div>
</div>
<ul>
<li>We can get a secondary grouping too! Let’s group by year as well</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>batting_tbl <span class="sc">|&gt;</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(G <span class="sc">&gt;</span> <span class="dv">50</span>, yearID <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2018</span>, <span class="dv">2019</span>, <span class="dv">2020</span>)) <span class="sc">|&gt;</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(teamID), playerID) <span class="sc">|&gt;</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(playerID, yearID, teamID, H<span class="sc">:</span>HR) <span class="sc">|&gt;</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Doubles"</span> <span class="ot">=</span> <span class="st">"X2B"</span>, <span class="st">"Triples"</span> <span class="ot">=</span> <span class="st">"X3B"</span>) <span class="sc">|&gt;</span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(teamID, yearID) <span class="sc">|&gt;</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Extra_Base_Hits =</span> Doubles <span class="sc">+</span> Triples <span class="sc">+</span> HR,</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">Singles =</span> H <span class="sc">-</span> Extra_Base_Hits,</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">H_Percentile =</span> <span class="fu">percent_rank</span>(H),</span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">H_Mean =</span> <span class="fu">mean</span>(H)) <span class="sc">|&gt;</span></span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(playerID, teamID, yearID, H, H_Mean, H_Percentile, <span class="fu">everything</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,172 x 11
# Groups:   teamID, yearID [90]
   playerID  teamID yearID     H H_Mean H_Percentile Doubles Triples    HR
   &lt;chr&gt;     &lt;fct&gt;   &lt;int&gt; &lt;int&gt;  &lt;dbl&gt;        &lt;dbl&gt;   &lt;int&gt;   &lt;int&gt; &lt;int&gt;
 1 adamsma01 WAS      2018    64   69.8        0.529       9       0    18
 2 adamsma01 WAS      2019    70   77.6        0.438      14       0    20
 3 cabreas01 WAS      2020    46   53.7        0.5         9       3     8
 4 difowi01  WAS      2018    94   69.8        0.706      14       7     7
 5 doolise01 WAS      2019     0   77.6        0           0       0     0
 6 doziebr01 WAS      2019    99   77.6        0.625      20       0    20
 7 eatonad02 WAS      2018    96   69.8        0.765      18       1     5
 8 eatonad02 WAS      2019   158   77.6        0.938      25       7    15
 9 gomesya01 WAS      2019    70   77.6        0.438      16       0    12
10 gracema02 WAS      2018     1   69.8        0.118       0       0     0
# i 1,162 more rows
# i 2 more variables: Extra_Base_Hits &lt;int&gt;, Singles &lt;int&gt;</code></pre>
</div>
</div>
<p>We are really able to do a lot quickly with these functions! Nice. One other commonly used function in <code>mutate()</code> is <code>ifelse()</code> or <code>if_else()</code> (the <code>tidyverse</code> version with slightly more restrictive functionality).</p>
<ul>
<li><p>Let’s add a new variable that compares a number of hits to the mean. If it is more than the mean we’ll say “Great”, if it is less than the mean we’ll say “Needs some work”.</p>
<ul>
<li>Recall <code>ifelse()</code> takes in a vector of conditions as the first argument. The second argument is what to do when <code>TRUE</code> and the third what to do when <code>FALSE</code>.</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>batting_tbl <span class="sc">|&gt;</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(G <span class="sc">&gt;</span> <span class="dv">50</span>, yearID <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2018</span>, <span class="dv">2019</span>, <span class="dv">2020</span>)) <span class="sc">|&gt;</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(teamID), playerID) <span class="sc">|&gt;</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(playerID, yearID, teamID, H<span class="sc">:</span>HR) <span class="sc">|&gt;</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Doubles"</span> <span class="ot">=</span> <span class="st">"X2B"</span>, <span class="st">"Triples"</span> <span class="ot">=</span> <span class="st">"X3B"</span>) <span class="sc">|&gt;</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(teamID, yearID) <span class="sc">|&gt;</span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Extra_Base_Hits =</span> Doubles <span class="sc">+</span> Triples <span class="sc">+</span> HR,</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">Singles =</span> H <span class="sc">-</span> Extra_Base_Hits,</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">H_Percentile =</span> <span class="fu">percent_rank</span>(H),</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">H_Mean =</span> <span class="fu">mean</span>(H),</span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">Status =</span> <span class="fu">ifelse</span>(H <span class="sc">&gt;</span> H_Mean, </span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"Great"</span>, </span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"Needs some work"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(playerID, teamID, yearID, H, H_Mean, Status, H_Percentile, <span class="fu">everything</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,172 x 12
# Groups:   teamID, yearID [90]
   playerID teamID yearID     H H_Mean Status H_Percentile Doubles Triples    HR
   &lt;chr&gt;    &lt;fct&gt;   &lt;int&gt; &lt;int&gt;  &lt;dbl&gt; &lt;chr&gt;         &lt;dbl&gt;   &lt;int&gt;   &lt;int&gt; &lt;int&gt;
 1 adamsma~ WAS      2018    64   69.8 Needs~        0.529       9       0    18
 2 adamsma~ WAS      2019    70   77.6 Needs~        0.438      14       0    20
 3 cabreas~ WAS      2020    46   53.7 Needs~        0.5         9       3     8
 4 difowi01 WAS      2018    94   69.8 Great         0.706      14       7     7
 5 doolise~ WAS      2019     0   77.6 Needs~        0           0       0     0
 6 doziebr~ WAS      2019    99   77.6 Great         0.625      20       0    20
 7 eatonad~ WAS      2018    96   69.8 Great         0.765      18       1     5
 8 eatonad~ WAS      2019   158   77.6 Great         0.938      25       7    15
 9 gomesya~ WAS      2019    70   77.6 Needs~        0.438      16       0    12
10 gracema~ WAS      2018     1   69.8 Needs~        0.118       0       0     0
# i 1,162 more rows
# i 2 more variables: Extra_Base_Hits &lt;int&gt;, Singles &lt;int&gt;</code></pre>
</div>
</div>
</section>
<section id="quick-r-video" class="level3">
<h3 class="anchored" data-anchor-id="quick-r-video">Quick R Video</h3>
<p>Please pop this video out and watch it in the full panopto player!</p>
<iframe src="https://ncsu.hosted.panopto.com/Panopto/Pages/Embed.aspx?id=e6c52a4f-e12f-42b3-ba62-b17c010a973a&amp;autoplay=false&amp;offerviewer=true&amp;showtitle=true&amp;showbrand=true&amp;captions=false&amp;interactivity=all" height="405" width="720" style="border: 1px solid #464646;" allowfullscreen="" allow="autoplay" aria-label="Panopto Embedded Video Player" aria-description="19 - Manipulating Data with dplyr"></iframe>
</section>
<section id="recap" class="level3">
<h3 class="anchored" data-anchor-id="recap">Recap!</h3>
<p><code>dplyr</code> gives us a ton of functionality for doing common data manipulations</p>
<ul>
<li><code>as_tibble()</code> - coerce a data frame to a tibble</li>
<li><code>filter()</code> - subset rows</li>
<li><code>arrange()</code> - reorder rows</li>
<li><code>select()</code> - subset/reorder columns</li>
<li><code>rename()</code> - rename columns</li>
<li><code>mutate()</code> - add new variables to the tibble</li>
</ul>
<p>The functionality of selecting columns described in the help for <code>select()</code> can be used in many places across the <code>tidyverse</code> and the functions <code>group_by()</code> and <code>ifelse()</code> are really useful as well!</p>
<ul>
<li><a href="https://rstudio.github.io/cheatsheets/html/data-transformation.html"><code>dplyr</code> Cheat Sheet</a> (PDF version on the right hand side of the page)</li>
</ul>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../Notes/18-Reading_Excel_Data.html" class="pagination-link" aria-label="Reading Excel Data">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Reading Excel Data</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../Notes/20-Manipulating_Data_with_tidyr.html" class="pagination-link" aria-label="Manipulating Data with `tidyr`">
        <span class="nav-page-text">Manipulating Data with <code>tidyr</code></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>