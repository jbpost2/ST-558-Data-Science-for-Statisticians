<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2025-07-05">

<title>ST 558 Data Science for Statisticians (R) - Manipulating Data with dplyr</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../Notes/20-Manipulating_Data_with_tidyr.html" rel="next">
<link href="../Notes/18-Reading_Excel_Data.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">ST 558 Data Science for Statisticians (R)</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="../index.html" aria-current="page"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/jbpost2/ST-558-Data-Science-for-Statisticians"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../Notes/10_5-Week2_3_em.html">Topic 2: Tidyverse &amp; EDA</a></li><li class="breadcrumb-item"><a href="../Notes/19-Manipulating_Data_with_dplyr.html">Manipulating Data with <code>dplyr</code></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Science for Statisticians</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false">
 <span class="menu-text">Topic 1: Data Science &amp; R Basics</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/01-What_is_Data_Science.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">What is Data Science?</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/02-Workflows_Git_GitHub_Basics_Landing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Workflows &amp; `Git`/`GitHub` Basics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/03-Git_GitHub_Practice.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">`Git` &amp; `GitHub` Practice</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/04-R_Basics_Landing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><code>R</code> Basics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/05-R_Projects_Connecting_with_GitHub.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R projects and Connecting with Github</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/06-Quarto.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Quarto Basics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/06_5-Week1_2_em.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 2 Overview</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/07-Base_R_Data_Structures_Vectors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Base R Data Structures: Vectors</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/08-Base_R_Data_Structures_Matrices.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Base R Data Structures: Matrices</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/09-Base_R_Data_Structures_Data_Frames.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Base R Data Structures: Data Frames</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/10-Base_R_Data_Structures_Lists.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Base R Data Structures: Lists</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/11-Control_Flow_Logicals_if_then_else.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Control Flow: Logicals &amp; if/then/else</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/12-Control_Flow_Loops.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Control Flow: Loops</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/13-Control_Flow_Vectorized_Functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Control Flow: Vectorized Functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/14-Writing_Functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Writing Functions</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Topic 2: Tidyverse &amp; EDA</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/10_5-Week2_3_em.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 3 Overview</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/15-Packages_Landing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Packages</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/16-Tidyverse_Essentials.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tidyverse Essentials</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/17-Reading_Delimited_Data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Reading Delimited Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/18-Reading_Excel_Data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Reading Excel Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/19-Manipulating_Data_with_dplyr.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Manipulating Data with <code>dplyr</code></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/20-Manipulating_Data_with_tidyr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Manipulating Data with <code>tidyr</code></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/21-Connecting_to_Databases.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Databases and Basic SQL</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/22-SQL_Style_Joins_Landing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">SQL Joins</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/23_5-Week3_4_em.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 4 Overview</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/24-EDA_Concepts_Landing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">EDA Concepts</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/25-Summarizing_Categorical_Variables.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Creating Contingency Tables</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/26-Barplots_ggplot_Basics_Landing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Barplots &amp; `ggplot2` Basics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/27-Numerical_Variable_Summaries.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Numerical Variable Summaries</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/28-Numeric_Variable_Graphs_Landing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Numeric Variable Graphs</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/28_5-Week_5_overview_em.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 5 Overview</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
 <span class="menu-text">Topic 3: Better Programming</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/29.1-Week6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 6 Overview</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/29-Big_Recap_Landing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Recap and Direction!</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/30-Apply_Family_Landing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Apply Family of Functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/31-purrr_Landing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><code>purrr</code> Package</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/32-Advanced_Function_Writing_Landing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Advanced Function Writing</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/23-Querying_APIs_Landing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Querying APIs</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">
 <span class="menu-text">Topic 4: R Shiny Dashboards</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/33.1-Week7.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 7 Overview</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/33-RShiny_Introduction_Landing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to R Shiny</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/34-RShiny_Tutorials_I.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tutorials to Complete Part I</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/35-RShiny_Connecting_UI_Server_Landing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Connecting the UI and Server</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/36-RShiny_Tutorials_II.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tutorials to Complete Part II</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/37-RShiny_Reactivity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Reactivity</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/38-RShiny_Tutorials_III.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tutorials to Complete Part III</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/39-RShiny_Dynamic_UI_Landing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Dynamic User Interfaces</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/40-RShiny_UI_Layouts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Flexible UI Layouts &amp; Dashboards</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/41-RShiny_Articles_I.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Useful R Shiny Articles I</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/42-RShiny_Debugging_Other_Useful_Things_Landing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Debugging &amp; Other Useful Things</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/43-RShiny_Articles_II.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Useful R Shiny Articles II</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false">
 <span class="menu-text">Topic 5: Predictive Modeling</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/44.5-Week8.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 8 Overview</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/44-Modeling_Concepts_Inference_Prediction_Landing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modeling Concepts</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/45-Prediction_Testing_Training.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Prediction &amp; Training/Test Sets</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/46-Cross_Validation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Cross-Validation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/47-Multiple_Linear_Regression_Landing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multiple Linear Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/48-Modeling_With_tidymodels_Landing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modeling with <code>tidymodels</code></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/49-tidymodels_Tutorial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><code>tidymodels</code> Tutorial</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/50-LASSO_Models_Selecting_Models_CV_Test_Set.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">LASSO Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/51-Modeling_Recap_Landing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modeling Recap</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/51.5-Week9.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 9 Overview</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/52-Logistic_Regression_Models_Landing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Logistic Regression Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/53-Regression_Classification_Trees.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Regression &amp; Classification Trees</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/54-Ensemble_Trees_Bagging_Random_Forests_Landing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Ensemble Trees</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false">
 <span class="menu-text">Topic 6: APIs &amp; Docker</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/55.5-Week10.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 10 Overview</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/55-Creating_API_Landing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Creating an API in <code>R</code></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/56-Docker_Landing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Docker Basics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/57-Building_Docker_Landing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Building a Docker Image</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Notes/58-Dockerizing_Shiny_Landing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Dockerizing a Shiny App</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#coercing-a-data-frame-to-a-tibble" id="toc-coercing-a-data-frame-to-a-tibble" class="nav-link active" data-scroll-target="#coercing-a-data-frame-to-a-tibble">Coercing a Data Frame to a Tibble</a></li>
  <li><a href="#row-manipulations-with-dplyr" id="toc-row-manipulations-with-dplyr" class="nav-link" data-scroll-target="#row-manipulations-with-dplyr">Row Manipulations with <code>dplyr</code></a>
  <ul class="collapse">
  <li><a href="#filter" id="toc-filter" class="nav-link" data-scroll-target="#filter"><code>filter()</code></a></li>
  <li><a href="#arrange" id="toc-arrange" class="nav-link" data-scroll-target="#arrange"><code>arrange()</code></a></li>
  </ul></li>
  <li><a href="#column-manipulations-with-dplyr" id="toc-column-manipulations-with-dplyr" class="nav-link" data-scroll-target="#column-manipulations-with-dplyr">Column Manipulations with <code>dplyr</code></a>
  <ul class="collapse">
  <li><a href="#select---subset-columns" id="toc-select---subset-columns" class="nav-link" data-scroll-target="#select---subset-columns"><code>select()</code> - Subset Columns</a></li>
  <li><a href="#rename" id="toc-rename" class="nav-link" data-scroll-target="#rename"><code>rename()</code></a></li>
  <li><a href="#creating-new-variables-with-dplyr" id="toc-creating-new-variables-with-dplyr" class="nav-link" data-scroll-target="#creating-new-variables-with-dplyr">Creating New Variables with <code>dplyr</code></a></li>
  <li><a href="#quick-r-video" id="toc-quick-r-video" class="nav-link" data-scroll-target="#quick-r-video">Quick R Video</a></li>
  <li><a href="#recap" id="toc-recap" class="nav-link" data-scroll-target="#recap">Recap!</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../Notes/10_5-Week2_3_em.html">Topic 2: Tidyverse &amp; EDA</a></li><li class="breadcrumb-item"><a href="../Notes/19-Manipulating_Data_with_dplyr.html">Manipulating Data with <code>dplyr</code></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Manipulating Data with <code>dplyr</code></h1>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">2025-07-05</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p>Thinking about our big goals (doing data science):</p>
<ul>
<li>Read in raw data and manipulate it</li>
<li>Combine data sources</li>
<li>Summarize data to glean insights</li>
<li>Apply common analysis methods</li>
<li>Communicate Effectively</li>
</ul>
<p>We now have a good idea about reading in certain types of data. Let’s take a bit of time going through common data manipulation tasks before returning to reading data in.</p>
<p>The two major tasks we’ll consider are</p>
<ul>
<li><p>Row manipulations</p>
<ul>
<li><strong>filtering</strong> or subsetting our observations</li>
<li><strong>arranging</strong> our observations in some order</li>
</ul></li>
<li><p>Column manipulations</p>
<ul>
<li><strong>selecting</strong> a subset of our variables</li>
<li><strong>rename</strong> a column</li>
<li><strong>mutating</strong> our data frame to create a new variable</li>
</ul></li>
</ul>
<p>We can use <code>Base R</code> for this (via <code>[</code> or the <code>subset()</code> function). However, the <code>tidyverse</code> has a more coherent set of functions to allow us to do all of our tasks without having to spend as much time learning syntax. So let’s go that route!</p>
<p>Recall the basic fundamentals about the <code>tidyverse</code>:</p>
<ul>
<li><p>(Almost) all functions take in <code>tibble</code>s (special data frames) and output <code>tibble</code>s</p></li>
<li><p>(Almost) all functions have similar syntax!</p>
<p><code>function(tibble, arguments, ...)</code></p>
<ul>
<li>Allows for easy chaining!</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>my_data <span class="sc">|&gt;</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(var1<span class="sc">:</span>var10, var20) <span class="sc">|&gt;</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(var1 <span class="sc">==</span> <span class="st">"first"</span>) <span class="sc">|&gt;</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">new_var =</span> <span class="fu">lag</span>(var20)) <span class="sc">|&gt;</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  ...</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="coercing-a-data-frame-to-a-tibble" class="level2">
<h2 class="anchored" data-anchor-id="coercing-a-data-frame-to-a-tibble">Coercing a Data Frame to a Tibble</h2>
<p>If you happen to have a <code>data frame</code> that isn’t already a <code>tibble</code>, we can easily coerce it using the <code>as_tibble()</code> function.</p>
<p>Consider a data set on major league baseball players (batting statistics):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Lahman)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'Lahman' was built under R version 4.4.2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>batting_tbl <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(Batting)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>batting_tbl</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 113,799 × 22
   playerID  yearID stint teamID lgID      G    AB     R     H   X2B   X3B    HR
   &lt;chr&gt;      &lt;int&gt; &lt;int&gt; &lt;fct&gt;  &lt;fct&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
 1 aardsda01   2004     1 SFN    NL       11     0     0     0     0     0     0
 2 aardsda01   2006     1 CHN    NL       45     2     0     0     0     0     0
 3 aardsda01   2007     1 CHA    AL       25     0     0     0     0     0     0
 4 aardsda01   2008     1 BOS    AL       47     1     0     0     0     0     0
 5 aardsda01   2009     1 SEA    AL       73     0     0     0     0     0     0
 6 aardsda01   2010     1 SEA    AL       53     0     0     0     0     0     0
 7 aardsda01   2012     1 NYA    AL        1     0     0     0     0     0     0
 8 aardsda01   2013     1 NYN    NL       43     0     0     0     0     0     0
 9 aardsda01   2015     1 ATL    NL       33     1     0     0     0     0     0
10 aaronha01   1954     1 ML1    NL      122   468    58   131    27     6    13
# ℹ 113,789 more rows
# ℹ 10 more variables: RBI &lt;int&gt;, SB &lt;int&gt;, CS &lt;int&gt;, BB &lt;int&gt;, SO &lt;int&gt;,
#   IBB &lt;int&gt;, HBP &lt;int&gt;, SH &lt;int&gt;, SF &lt;int&gt;, GIDP &lt;int&gt;</code></pre>
</div>
</div>
<p>Nice, now we can work on this <code>tibble</code>!</p>
</section>
<section id="row-manipulations-with-dplyr" class="level2">
<h2 class="anchored" data-anchor-id="row-manipulations-with-dplyr">Row Manipulations with <code>dplyr</code></h2>
<p>A common task is to only grab certain types of observations (<strong>filter rows</strong>)</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/filterVisualF.png" class="img-fluid quarto-figure quarto-figure-center figure-img" alt="A visual of a data frame is shown with three columns. Only rows where the third column was equal to FALSE are returned." width="500"></p>
</figure>
</div>
</div>
</div>
<p>or rearrange the order of the observations (rows). The two functions from <code>dplyr</code> that help us here are</p>
<ul>
<li><code>filter()</code> - subset <strong>rows</strong></li>
<li><code>arrange()</code> - reorder <strong>rows</strong></li>
</ul>
<section id="filter" class="level3">
<h3 class="anchored" data-anchor-id="filter"><code>filter()</code></h3>
<p><code>filter()</code> generally takes a <code>tibble</code> as its first argument and then a logical vector as the next (of the same length as the number of rows):</p>
<ul>
<li>Returns observations where the number of games played is greater than 50 (the <code>G</code> column):</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(batting_tbl, G <span class="sc">&gt;</span> <span class="dv">50</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 41,727 × 22
   playerID  yearID stint teamID lgID      G    AB     R     H   X2B   X3B    HR
   &lt;chr&gt;      &lt;int&gt; &lt;int&gt; &lt;fct&gt;  &lt;fct&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
 1 aardsda01   2009     1 SEA    AL       73     0     0     0     0     0     0
 2 aardsda01   2010     1 SEA    AL       53     0     0     0     0     0     0
 3 aaronha01   1954     1 ML1    NL      122   468    58   131    27     6    13
 4 aaronha01   1955     1 ML1    NL      153   602   105   189    37     9    27
 5 aaronha01   1956     1 ML1    NL      153   609   106   200    34    14    26
 6 aaronha01   1957     1 ML1    NL      151   615   118   198    27     6    44
 7 aaronha01   1958     1 ML1    NL      153   601   109   196    34     4    30
 8 aaronha01   1959     1 ML1    NL      154   629   116   223    46     7    39
 9 aaronha01   1960     1 ML1    NL      153   590   102   172    20    11    40
10 aaronha01   1961     1 ML1    NL      155   603   115   197    39    10    34
# ℹ 41,717 more rows
# ℹ 10 more variables: RBI &lt;int&gt;, SB &lt;int&gt;, CS &lt;int&gt;, BB &lt;int&gt;, SO &lt;int&gt;,
#   IBB &lt;int&gt;, HBP &lt;int&gt;, SH &lt;int&gt;, SF &lt;int&gt;, GIDP &lt;int&gt;</code></pre>
</div>
</div>
<p>Notice the number of observations is far less now!</p>
<ul>
<li>Of course, we’ll do many operations so let’s use chaining even in this simple case:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>batting_tbl <span class="sc">|&gt;</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(G <span class="sc">&gt;</span> <span class="dv">50</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 41,727 × 22
   playerID  yearID stint teamID lgID      G    AB     R     H   X2B   X3B    HR
   &lt;chr&gt;      &lt;int&gt; &lt;int&gt; &lt;fct&gt;  &lt;fct&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
 1 aardsda01   2009     1 SEA    AL       73     0     0     0     0     0     0
 2 aardsda01   2010     1 SEA    AL       53     0     0     0     0     0     0
 3 aaronha01   1954     1 ML1    NL      122   468    58   131    27     6    13
 4 aaronha01   1955     1 ML1    NL      153   602   105   189    37     9    27
 5 aaronha01   1956     1 ML1    NL      153   609   106   200    34    14    26
 6 aaronha01   1957     1 ML1    NL      151   615   118   198    27     6    44
 7 aaronha01   1958     1 ML1    NL      153   601   109   196    34     4    30
 8 aaronha01   1959     1 ML1    NL      154   629   116   223    46     7    39
 9 aaronha01   1960     1 ML1    NL      153   590   102   172    20    11    40
10 aaronha01   1961     1 ML1    NL      155   603   115   197    39    10    34
# ℹ 41,717 more rows
# ℹ 10 more variables: RBI &lt;int&gt;, SB &lt;int&gt;, CS &lt;int&gt;, BB &lt;int&gt;, SO &lt;int&gt;,
#   IBB &lt;int&gt;, HBP &lt;int&gt;, SH &lt;int&gt;, SF &lt;int&gt;, GIDP &lt;int&gt;</code></pre>
</div>
</div>
<ul>
<li><p>If we want to return observations where than one condition is <code>TRUE</code> we can either pass additional arguments or use the compound logical operator <code>&amp;</code> we discussed earlier.</p>
<ul>
<li>Condition on those that played more than 50 games and played in 2018</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>batting_tbl <span class="sc">|&gt;</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(G <span class="sc">&gt;</span> <span class="dv">50</span> <span class="sc">&amp;</span> yearID <span class="sc">==</span> <span class="dv">2018</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 518 × 22
   playerID  yearID stint teamID lgID      G    AB     R     H   X2B   X3B    HR
   &lt;chr&gt;      &lt;int&gt; &lt;int&gt; &lt;fct&gt;  &lt;fct&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
 1 abreujo02   2018     1 CHA    AL      128   499    68   132    36     1    22
 2 acunaro01   2018     1 ATL    NL      111   433    78   127    26     4    26
 3 adamewi01   2018     1 TBA    AL       85   288    43    80     7     0    10
 4 adamsma01   2018     1 WAS    NL       94   249    37    64     9     0    18
 5 adducji02   2018     1 DET    AL       59   176    19    47     8     2     3
 6 adriaeh01   2018     1 MIN    AL      114   335    42    84    23     1     6
 7 aguilje01   2018     1 MIL    NL      149   492    80   135    25     0    35
 8 ahmedni01   2018     1 ARI    NL      153   516    61   121    33     5    16
 9 albieoz01   2018     1 ATL    NL      158   639   105   167    40     5    24
10 alexasc01   2018     1 LAN    NL       73     5     0     0     0     0     0
# ℹ 508 more rows
# ℹ 10 more variables: RBI &lt;int&gt;, SB &lt;int&gt;, CS &lt;int&gt;, BB &lt;int&gt;, SO &lt;int&gt;,
#   IBB &lt;int&gt;, HBP &lt;int&gt;, SH &lt;int&gt;, SF &lt;int&gt;, GIDP &lt;int&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">#equivalently</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>batting_tbl <span class="sc">|&gt;</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(G <span class="sc">&gt;</span> <span class="dv">50</span>, yearID <span class="sc">==</span> <span class="dv">2018</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 518 × 22
   playerID  yearID stint teamID lgID      G    AB     R     H   X2B   X3B    HR
   &lt;chr&gt;      &lt;int&gt; &lt;int&gt; &lt;fct&gt;  &lt;fct&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
 1 abreujo02   2018     1 CHA    AL      128   499    68   132    36     1    22
 2 acunaro01   2018     1 ATL    NL      111   433    78   127    26     4    26
 3 adamewi01   2018     1 TBA    AL       85   288    43    80     7     0    10
 4 adamsma01   2018     1 WAS    NL       94   249    37    64     9     0    18
 5 adducji02   2018     1 DET    AL       59   176    19    47     8     2     3
 6 adriaeh01   2018     1 MIN    AL      114   335    42    84    23     1     6
 7 aguilje01   2018     1 MIL    NL      149   492    80   135    25     0    35
 8 ahmedni01   2018     1 ARI    NL      153   516    61   121    33     5    16
 9 albieoz01   2018     1 ATL    NL      158   639   105   167    40     5    24
10 alexasc01   2018     1 LAN    NL       73     5     0     0     0     0     0
# ℹ 508 more rows
# ℹ 10 more variables: RBI &lt;int&gt;, SB &lt;int&gt;, CS &lt;int&gt;, BB &lt;int&gt;, SO &lt;int&gt;,
#   IBB &lt;int&gt;, HBP &lt;int&gt;, SH &lt;int&gt;, SF &lt;int&gt;, GIDP &lt;int&gt;</code></pre>
</div>
</div>
<ul>
<li>Often we want to check if a variable is in a specific group of values. We might think this is the way:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="do">####wrong!!!!! Common mistake</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>batting_tbl <span class="sc">|&gt;</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(G <span class="sc">&gt;</span> <span class="dv">50</span>, yearID <span class="sc">==</span> <span class="fu">c</span>(<span class="dv">2018</span>, <span class="dv">2019</span>, <span class="dv">2020</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 387 × 22
   playerID  yearID stint teamID lgID      G    AB     R     H   X2B   X3B    HR
   &lt;chr&gt;      &lt;int&gt; &lt;int&gt; &lt;fct&gt;  &lt;fct&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
 1 adamsma01   2018     1 WAS    NL       94   249    37    64     9     0    18
 2 alberma01   2019     1 MIL    NL       67     0     0     0     0     0     0
 3 albieoz01   2018     1 ATL    NL      158   639   105   167    40     5    24
 4 albieoz01   2019     1 ATL    NL      160   640   102   189    43     8    24
 5 alfarjo01   2018     1 PHI    NL      108   344    35    90    16     2    10
 6 alfarjo01   2019     1 MIA    NL      130   431    44   113    14     1    18
 7 allengr01   2018     1 CLE    AL       91   265    36    68    11     3     2
 8 allengr01   2019     1 CLE    AL       89   231    30    53     9     3     4
 9 almoral01   2018     1 CHN    NL      152   444    62   127    24     1     5
10 almoral01   2019     1 CHN    NL      130   339    41    80    11     1    12
# ℹ 377 more rows
# ℹ 10 more variables: RBI &lt;int&gt;, SB &lt;int&gt;, CS &lt;int&gt;, BB &lt;int&gt;, SO &lt;int&gt;,
#   IBB &lt;int&gt;, HBP &lt;int&gt;, SH &lt;int&gt;, SF &lt;int&gt;, GIDP &lt;int&gt;</code></pre>
</div>
</div>
<ul>
<li>Here, R uses <em>recycling</em> on the vector and actually compares the 1st element to 2018, the 2nd to 2019, the third to 2020, the fourth to 2018, the fifth to 2019, …</li>
<li>Use <code>%in%</code> to choose any observations matching an element of a vector</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>batting_tbl <span class="sc">|&gt;</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(G <span class="sc">&gt;</span> <span class="dv">50</span>, yearID <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2018</span>, <span class="dv">2019</span>, <span class="dv">2020</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,172 × 22
   playerID  yearID stint teamID lgID      G    AB     R     H   X2B   X3B    HR
   &lt;chr&gt;      &lt;int&gt; &lt;int&gt; &lt;fct&gt;  &lt;fct&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
 1 abreujo02   2018     1 CHA    AL      128   499    68   132    36     1    22
 2 abreujo02   2019     1 CHA    AL      159   634    85   180    38     1    33
 3 abreujo02   2020     1 CHA    AL       60   240    43    76    15     0    19
 4 acunaro01   2018     1 ATL    NL      111   433    78   127    26     4    26
 5 acunaro01   2019     1 ATL    NL      156   626   127   175    22     2    41
 6 adamewi01   2018     1 TBA    AL       85   288    43    80     7     0    10
 7 adamewi01   2019     1 TBA    AL      152   531    69   135    25     1    20
 8 adamewi01   2020     1 TBA    AL       54   185    29    48    15     1     8
 9 adamsma01   2018     1 WAS    NL       94   249    37    64     9     0    18
10 adamsma01   2019     1 WAS    NL      111   310    42    70    14     0    20
# ℹ 1,162 more rows
# ℹ 10 more variables: RBI &lt;int&gt;, SB &lt;int&gt;, CS &lt;int&gt;, BB &lt;int&gt;, SO &lt;int&gt;,
#   IBB &lt;int&gt;, HBP &lt;int&gt;, SH &lt;int&gt;, SF &lt;int&gt;, GIDP &lt;int&gt;</code></pre>
</div>
</div>
<ul>
<li><p>If we want an <em>or</em> condition, we use the compound logical operator for that</p>
<ul>
<li>Here, grab those with either games greater than 100 or those that played in 2018, 2019, or 2020 (or both)</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>batting_tbl <span class="sc">|&gt;</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(G <span class="sc">&gt;</span> <span class="dv">100</span> <span class="sc">|</span> yearID <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2018</span>, <span class="dv">2019</span>, <span class="dv">2020</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 25,417 × 22
   playerID  yearID stint teamID lgID      G    AB     R     H   X2B   X3B    HR
   &lt;chr&gt;      &lt;int&gt; &lt;int&gt; &lt;fct&gt;  &lt;fct&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
 1 aaronha01   1954     1 ML1    NL      122   468    58   131    27     6    13
 2 aaronha01   1955     1 ML1    NL      153   602   105   189    37     9    27
 3 aaronha01   1956     1 ML1    NL      153   609   106   200    34    14    26
 4 aaronha01   1957     1 ML1    NL      151   615   118   198    27     6    44
 5 aaronha01   1958     1 ML1    NL      153   601   109   196    34     4    30
 6 aaronha01   1959     1 ML1    NL      154   629   116   223    46     7    39
 7 aaronha01   1960     1 ML1    NL      153   590   102   172    20    11    40
 8 aaronha01   1961     1 ML1    NL      155   603   115   197    39    10    34
 9 aaronha01   1962     1 ML1    NL      156   592   127   191    28     6    45
10 aaronha01   1963     1 ML1    NL      161   631   121   201    29     4    44
# ℹ 25,407 more rows
# ℹ 10 more variables: RBI &lt;int&gt;, SB &lt;int&gt;, CS &lt;int&gt;, BB &lt;int&gt;, SO &lt;int&gt;,
#   IBB &lt;int&gt;, HBP &lt;int&gt;, SH &lt;int&gt;, SF &lt;int&gt;, GIDP &lt;int&gt;</code></pre>
</div>
</div>
<ul>
<li>Again, note the change in the observation count!</li>
</ul>
</section>
<section id="arrange" class="level3">
<h3 class="anchored" data-anchor-id="arrange"><code>arrange()</code></h3>
<p>The other major observation (row) manipulation is to reorder the observations (rows). This is done through <code>arrange()</code> from <code>dplyr</code> (or <code>sort()</code> in <code>Base R</code>)</p>
<ul>
<li>Let’s take our result from above and reorder by <code>teamID</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>batting_tbl <span class="sc">|&gt;</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(G <span class="sc">&gt;</span> <span class="dv">100</span>, yearID <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2018</span>, <span class="dv">2019</span>, <span class="dv">2020</span>)) <span class="sc">|&gt;</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(teamID)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 467 × 22
   playerID  yearID stint teamID lgID      G    AB     R     H   X2B   X3B    HR
   &lt;chr&gt;      &lt;int&gt; &lt;int&gt; &lt;fct&gt;  &lt;fct&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
 1 ahmedni01   2018     1 ARI    NL      153   516    61   121    33     5    16
 2 ahmedni01   2019     1 ARI    NL      158   556    79   141    33     6    19
 3 descada01   2018     1 ARI    NL      138   349    54    83    22     4    13
 4 dysonja01   2019     1 ARI    NL      130   400    65    92    11     2     7
 5 escobed01   2019     1 ARI    NL      158   636    94   171    29    10    35
 6 goldspa01   2018     1 ARI    NL      158   593    95   172    35     5    33
 7 jonesad01   2019     1 ARI    NL      137   485    66   126    25     1    16
 8 kellyca02   2019     1 ARI    NL      111   314    46    77    19     0    18
 9 marteke01   2018     1 ARI    NL      153   520    68   135    26    12    14
10 marteke01   2019     1 ARI    NL      144   569    97   187    36     9    32
# ℹ 457 more rows
# ℹ 10 more variables: RBI &lt;int&gt;, SB &lt;int&gt;, CS &lt;int&gt;, BB &lt;int&gt;, SO &lt;int&gt;,
#   IBB &lt;int&gt;, HBP &lt;int&gt;, SH &lt;int&gt;, SF &lt;int&gt;, GIDP &lt;int&gt;</code></pre>
</div>
</div>
<ul>
<li><p>Remember to read the pipe (<code>|&gt;</code>) as ‘then’. Here we would say:</p>
<ul>
<li><p>Take the batting tibble and then</p></li>
<li><p>filter the rows to only include those with games greater than 100 and those that played in 2018-2020 and then</p></li>
<li><p>arrange the rows by the team name</p></li>
</ul></li>
<li><p>We can obtain a secondary arrangement by giving a second column</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>batting_tbl <span class="sc">|&gt;</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(G <span class="sc">&gt;</span> <span class="dv">100</span>, yearID <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2018</span>, <span class="dv">2019</span>, <span class="dv">2020</span>)) <span class="sc">|&gt;</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(teamID, playerID)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 467 × 22
   playerID  yearID stint teamID lgID      G    AB     R     H   X2B   X3B    HR
   &lt;chr&gt;      &lt;int&gt; &lt;int&gt; &lt;fct&gt;  &lt;fct&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
 1 ahmedni01   2018     1 ARI    NL      153   516    61   121    33     5    16
 2 ahmedni01   2019     1 ARI    NL      158   556    79   141    33     6    19
 3 descada01   2018     1 ARI    NL      138   349    54    83    22     4    13
 4 dysonja01   2019     1 ARI    NL      130   400    65    92    11     2     7
 5 escobed01   2019     1 ARI    NL      158   636    94   171    29    10    35
 6 goldspa01   2018     1 ARI    NL      158   593    95   172    35     5    33
 7 jonesad01   2019     1 ARI    NL      137   485    66   126    25     1    16
 8 kellyca02   2019     1 ARI    NL      111   314    46    77    19     0    18
 9 marteke01   2018     1 ARI    NL      153   520    68   135    26    12    14
10 marteke01   2019     1 ARI    NL      144   569    97   187    36     9    32
# ℹ 457 more rows
# ℹ 10 more variables: RBI &lt;int&gt;, SB &lt;int&gt;, CS &lt;int&gt;, BB &lt;int&gt;, SO &lt;int&gt;,
#   IBB &lt;int&gt;, HBP &lt;int&gt;, SH &lt;int&gt;, SF &lt;int&gt;, GIDP &lt;int&gt;</code></pre>
</div>
</div>
<ul>
<li>We can reorder descending on a variable</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>batting_tbl <span class="sc">|&gt;</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(G <span class="sc">&gt;</span> <span class="dv">100</span>, yearID <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2018</span>, <span class="dv">2019</span>, <span class="dv">2020</span>)) <span class="sc">|&gt;</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(teamID), playerID)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 467 × 22
   playerID  yearID stint teamID lgID      G    AB     R     H   X2B   X3B    HR
   &lt;chr&gt;      &lt;int&gt; &lt;int&gt; &lt;fct&gt;  &lt;fct&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
 1 adamsma01   2019     1 WAS    NL      111   310    42    70    14     0    20
 2 difowi01    2018     1 WAS    NL      148   408    55    94    14     7     7
 3 doziebr01   2019     1 WAS    NL      135   416    54    99    20     0    20
 4 eatonad02   2019     1 WAS    NL      151   566   103   158    25     7    15
 5 harpebr03   2018     1 WAS    NL      159   550   103   137    34     0    34
 6 kendrho01   2019     1 WAS    NL      121   334    61   115    23     1    17
 7 rendoan01   2018     1 WAS    NL      136   529    88   163    44     2    24
 8 rendoan01   2019     1 WAS    NL      146   545   117   174    44     3    34
 9 roblevi01   2019     1 WAS    NL      155   546    86   139    33     3    17
10 sotoju01    2018     1 WAS    NL      116   414    77   121    25     1    22
# ℹ 457 more rows
# ℹ 10 more variables: RBI &lt;int&gt;, SB &lt;int&gt;, CS &lt;int&gt;, BB &lt;int&gt;, SO &lt;int&gt;,
#   IBB &lt;int&gt;, HBP &lt;int&gt;, SH &lt;int&gt;, SF &lt;int&gt;, GIDP &lt;int&gt;</code></pre>
</div>
</div>
</section>
</section>
<section id="column-manipulations-with-dplyr" class="level2">
<h2 class="anchored" data-anchor-id="column-manipulations-with-dplyr">Column Manipulations with <code>dplyr</code></h2>
<p>We may want to subset our variables, rename them, or create new variables.</p>
<section id="select---subset-columns" class="level3">
<h3 class="anchored" data-anchor-id="select---subset-columns"><code>select()</code> - Subset Columns</h3>
<p>We call the subset of our variables <strong>selecting</strong> columns (or variables)</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/selectVisualF.png" class="img-fluid quarto-figure quarto-figure-center figure-img" alt="A visual of a data frame is shown with three columns. Only one column is chosen to be returned." width="400"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p>To return a single (probably simplified) column we looked at the following methods (one of which is in the <code>tidyverse</code>):</p>
<ul>
<li><code>dplyr::pull()</code></li>
<li><code>$</code></li>
<li><code>[ , ]</code></li>
</ul></li>
</ul>
<p>When we want to look at pulling more than one column, <code>select()</code> is much better!</p>
<ul>
<li><p>Suppose we just wanted to look at the <code>playerID</code>, <code>teamID</code>, and hits type variables: <code>H</code>, <code>X2B</code> <code>X3B</code>, and <code>HR</code> of the players in our subset</p></li>
<li><p>We can add in a <code>select()</code> function to our chain (thanks again coherent ecosystem!).</p>
<ul>
<li>One way is to simply list the columns you want:</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>batting_tbl <span class="sc">|&gt;</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(G <span class="sc">&gt;</span> <span class="dv">100</span>, yearID <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2018</span>, <span class="dv">2019</span>, <span class="dv">2020</span>)) <span class="sc">|&gt;</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(teamID), playerID) <span class="sc">|&gt;</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(playerID, teamID, H, X2B, X3B, HR)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 467 × 6
   playerID  teamID     H   X2B   X3B    HR
   &lt;chr&gt;     &lt;fct&gt;  &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
 1 adamsma01 WAS       70    14     0    20
 2 difowi01  WAS       94    14     7     7
 3 doziebr01 WAS       99    20     0    20
 4 eatonad02 WAS      158    25     7    15
 5 harpebr03 WAS      137    34     0    34
 6 kendrho01 WAS      115    23     1    17
 7 rendoan01 WAS      163    44     2    24
 8 rendoan01 WAS      174    44     3    34
 9 roblevi01 WAS      139    33     3    17
10 sotoju01  WAS      121    25     1    22
# ℹ 457 more rows</code></pre>
</div>
</div>
<ul>
<li><p>Where we really gain here is the ability to use helper functions when selecting columns!</p>
<ul>
<li><code>:</code> to select all contiguous columns</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>batting_tbl <span class="sc">|&gt;</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(G <span class="sc">&gt;</span> <span class="dv">100</span>, yearID <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2018</span>, <span class="dv">2019</span>, <span class="dv">2020</span>)) <span class="sc">|&gt;</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(teamID), playerID) <span class="sc">|&gt;</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(playerID, teamID, H<span class="sc">:</span>HR)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 467 × 6
   playerID  teamID     H   X2B   X3B    HR
   &lt;chr&gt;     &lt;fct&gt;  &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
 1 adamsma01 WAS       70    14     0    20
 2 difowi01  WAS       94    14     7     7
 3 doziebr01 WAS       99    20     0    20
 4 eatonad02 WAS      158    25     7    15
 5 harpebr03 WAS      137    34     0    34
 6 kendrho01 WAS      115    23     1    17
 7 rendoan01 WAS      163    44     2    24
 8 rendoan01 WAS      174    44     3    34
 9 roblevi01 WAS      139    33     3    17
10 sotoju01  WAS      121    25     1    22
# ℹ 457 more rows</code></pre>
</div>
</div>
<ul>
<li><code>starts_with()</code> and <code>ends_with()</code> are also really useful</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>batting_tbl <span class="sc">|&gt;</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(G <span class="sc">&gt;</span> <span class="dv">100</span>, yearID <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2018</span>, <span class="dv">2019</span>, <span class="dv">2020</span>)) <span class="sc">|&gt;</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(teamID), playerID) <span class="sc">|&gt;</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">ends_with</span>(<span class="st">"ID"</span>), G, AB, H<span class="sc">:</span>HR)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 467 × 10
   playerID  yearID teamID lgID      G    AB     H   X2B   X3B    HR
   &lt;chr&gt;      &lt;int&gt; &lt;fct&gt;  &lt;fct&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
 1 adamsma01   2019 WAS    NL      111   310    70    14     0    20
 2 difowi01    2018 WAS    NL      148   408    94    14     7     7
 3 doziebr01   2019 WAS    NL      135   416    99    20     0    20
 4 eatonad02   2019 WAS    NL      151   566   158    25     7    15
 5 harpebr03   2018 WAS    NL      159   550   137    34     0    34
 6 kendrho01   2019 WAS    NL      121   334   115    23     1    17
 7 rendoan01   2018 WAS    NL      136   529   163    44     2    24
 8 rendoan01   2019 WAS    NL      146   545   174    44     3    34
 9 roblevi01   2019 WAS    NL      155   546   139    33     3    17
10 sotoju01    2018 WAS    NL      116   414   121    25     1    22
# ℹ 457 more rows</code></pre>
</div>
</div>
<ul>
<li>We can combine those two as well using <code>&amp;</code> and <code>|</code> operators</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>batting_tbl <span class="sc">|&gt;</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(G <span class="sc">&gt;</span> <span class="dv">100</span>, yearID <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2018</span>, <span class="dv">2019</span>, <span class="dv">2020</span>)) <span class="sc">|&gt;</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(teamID), playerID) <span class="sc">|&gt;</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">ends_with</span>(<span class="st">"ID"</span>) <span class="sc">|</span> <span class="fu">starts_with</span>(<span class="st">"X"</span>), G, AB, H, HR)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 467 × 10
   playerID  yearID teamID lgID    X2B   X3B     G    AB     H    HR
   &lt;chr&gt;      &lt;int&gt; &lt;fct&gt;  &lt;fct&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
 1 adamsma01   2019 WAS    NL       14     0   111   310    70    20
 2 difowi01    2018 WAS    NL       14     7   148   408    94     7
 3 doziebr01   2019 WAS    NL       20     0   135   416    99    20
 4 eatonad02   2019 WAS    NL       25     7   151   566   158    15
 5 harpebr03   2018 WAS    NL       34     0   159   550   137    34
 6 kendrho01   2019 WAS    NL       23     1   121   334   115    17
 7 rendoan01   2018 WAS    NL       44     2   136   529   163    24
 8 rendoan01   2019 WAS    NL       44     3   146   545   174    34
 9 roblevi01   2019 WAS    NL       33     3   155   546   139    17
10 sotoju01    2018 WAS    NL       25     1   116   414   121    22
# ℹ 457 more rows</code></pre>
</div>
</div>
<ul>
<li>If our goal is really just to reorder the columns, we can use <code>everything()</code> after specifying the columns of interest</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>batting_tbl <span class="sc">|&gt;</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(G <span class="sc">&gt;</span> <span class="dv">100</span>, yearID <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2018</span>, <span class="dv">2019</span>, <span class="dv">2020</span>)) <span class="sc">|&gt;</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(teamID), playerID) <span class="sc">|&gt;</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(playerID, H<span class="sc">:</span>HR, <span class="fu">everything</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 467 × 22
   playerID      H   X2B   X3B    HR yearID stint teamID lgID      G    AB     R
   &lt;chr&gt;     &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;  &lt;int&gt; &lt;int&gt; &lt;fct&gt;  &lt;fct&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
 1 adamsma01    70    14     0    20   2019     1 WAS    NL      111   310    42
 2 difowi01     94    14     7     7   2018     1 WAS    NL      148   408    55
 3 doziebr01    99    20     0    20   2019     1 WAS    NL      135   416    54
 4 eatonad02   158    25     7    15   2019     1 WAS    NL      151   566   103
 5 harpebr03   137    34     0    34   2018     1 WAS    NL      159   550   103
 6 kendrho01   115    23     1    17   2019     1 WAS    NL      121   334    61
 7 rendoan01   163    44     2    24   2018     1 WAS    NL      136   529    88
 8 rendoan01   174    44     3    34   2019     1 WAS    NL      146   545   117
 9 roblevi01   139    33     3    17   2019     1 WAS    NL      155   546    86
10 sotoju01    121    25     1    22   2018     1 WAS    NL      116   414    77
# ℹ 457 more rows
# ℹ 10 more variables: RBI &lt;int&gt;, SB &lt;int&gt;, CS &lt;int&gt;, BB &lt;int&gt;, SO &lt;int&gt;,
#   IBB &lt;int&gt;, HBP &lt;int&gt;, SH &lt;int&gt;, SF &lt;int&gt;, GIDP &lt;int&gt;</code></pre>
</div>
</div>
<ul>
<li>See the help for <code>select()</code> for more information about selection features (<strong>these can usually be used in any <code>tidyverse</code> functions where you are selecting columns!</strong>)</li>
</ul>
</section>
<section id="rename" class="level3">
<h3 class="anchored" data-anchor-id="rename"><code>rename()</code></h3>
<p>We’ve seen the use of <code>colnames()</code> or <code>names()</code> to rename columns. Those are great but aren’t easy to chain. <code>rename()</code> comes in handy in this case!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>batting_tbl <span class="sc">|&gt;</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(G <span class="sc">&gt;</span> <span class="dv">100</span>, yearID <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2018</span>, <span class="dv">2019</span>, <span class="dv">2020</span>)) <span class="sc">|&gt;</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(teamID), playerID) <span class="sc">|&gt;</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(playerID, teamID, H<span class="sc">:</span>HR) <span class="sc">|&gt;</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Doubles"</span> <span class="ot">=</span> <span class="st">"X2B"</span>, <span class="st">"Triples"</span> <span class="ot">=</span> <span class="st">"X3B"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 467 × 6
   playerID  teamID     H Doubles Triples    HR
   &lt;chr&gt;     &lt;fct&gt;  &lt;int&gt;   &lt;int&gt;   &lt;int&gt; &lt;int&gt;
 1 adamsma01 WAS       70      14       0    20
 2 difowi01  WAS       94      14       7     7
 3 doziebr01 WAS       99      20       0    20
 4 eatonad02 WAS      158      25       7    15
 5 harpebr03 WAS      137      34       0    34
 6 kendrho01 WAS      115      23       1    17
 7 rendoan01 WAS      163      44       2    24
 8 rendoan01 WAS      174      44       3    34
 9 roblevi01 WAS      139      33       3    17
10 sotoju01  WAS      121      25       1    22
# ℹ 457 more rows</code></pre>
</div>
</div>
</section>
<section id="creating-new-variables-with-dplyr" class="level3">
<h3 class="anchored" data-anchor-id="creating-new-variables-with-dplyr">Creating New Variables with <code>dplyr</code></h3>
<p>Often we want to create new variables!</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/createVarVisualF.png" class="img-fluid quarto-figure quarto-figure-center figure-img" alt="A visual of a data frame is shown with three columns. A fourth column is created based on some conditions associated with the original three columns." width="500"></p>
</figure>
</div>
</div>
</div>
<p>This can be accomplished using <code>mutate()</code>. This function allows us to create one or more variables and append them to our tibble.</p>
<ul>
<li>For our dataset from above, suppose we wanted to create an “extra base hits” type column that is the sum of the doubles, triples, and home runs.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>batting_tbl <span class="sc">|&gt;</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(G <span class="sc">&gt;</span> <span class="dv">100</span>, yearID <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2018</span>, <span class="dv">2019</span>, <span class="dv">2020</span>)) <span class="sc">|&gt;</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(teamID), playerID) <span class="sc">|&gt;</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(playerID, teamID, H<span class="sc">:</span>HR) <span class="sc">|&gt;</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Doubles"</span> <span class="ot">=</span> <span class="st">"X2B"</span>, <span class="st">"Triples"</span> <span class="ot">=</span> <span class="st">"X3B"</span>) <span class="sc">|&gt;</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Extra_Base_Hits =</span> Doubles <span class="sc">+</span> Triples <span class="sc">+</span> HR)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 467 × 7
   playerID  teamID     H Doubles Triples    HR Extra_Base_Hits
   &lt;chr&gt;     &lt;fct&gt;  &lt;int&gt;   &lt;int&gt;   &lt;int&gt; &lt;int&gt;           &lt;int&gt;
 1 adamsma01 WAS       70      14       0    20              34
 2 difowi01  WAS       94      14       7     7              28
 3 doziebr01 WAS       99      20       0    20              40
 4 eatonad02 WAS      158      25       7    15              47
 5 harpebr03 WAS      137      34       0    34              68
 6 kendrho01 WAS      115      23       1    17              41
 7 rendoan01 WAS      163      44       2    24              70
 8 rendoan01 WAS      174      44       3    34              81
 9 roblevi01 WAS      139      33       3    17              53
10 sotoju01  WAS      121      25       1    22              48
# ℹ 457 more rows</code></pre>
</div>
</div>
<ul>
<li><p>If we want to add more than one variable, we just separate the variable definitions with a comma.</p>
<ul>
<li>Let’s add a <code>Singles</code> variable representing the number of hits minus the number of extra base hits</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>batting_tbl <span class="sc">|&gt;</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(G <span class="sc">&gt;</span> <span class="dv">100</span>, yearID <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2018</span>, <span class="dv">2019</span>, <span class="dv">2020</span>)) <span class="sc">|&gt;</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(teamID), playerID) <span class="sc">|&gt;</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(playerID, teamID, H<span class="sc">:</span>HR) <span class="sc">|&gt;</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Doubles"</span> <span class="ot">=</span> <span class="st">"X2B"</span>, <span class="st">"Triples"</span> <span class="ot">=</span> <span class="st">"X3B"</span>) <span class="sc">|&gt;</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Extra_Base_Hits =</span> Doubles <span class="sc">+</span> Triples <span class="sc">+</span> HR,</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">Singles =</span> H <span class="sc">-</span> Extra_Base_Hits) <span class="sc">|&gt;</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(playerID, teamID, Singles, Doubles<span class="sc">:</span>HR, H, Extra_Base_Hits)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 467 × 8
   playerID  teamID Singles Doubles Triples    HR     H Extra_Base_Hits
   &lt;chr&gt;     &lt;fct&gt;    &lt;int&gt;   &lt;int&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt;           &lt;int&gt;
 1 adamsma01 WAS         36      14       0    20    70              34
 2 difowi01  WAS         66      14       7     7    94              28
 3 doziebr01 WAS         59      20       0    20    99              40
 4 eatonad02 WAS        111      25       7    15   158              47
 5 harpebr03 WAS         69      34       0    34   137              68
 6 kendrho01 WAS         74      23       1    17   115              41
 7 rendoan01 WAS         93      44       2    24   163              70
 8 rendoan01 WAS         93      44       3    34   174              81
 9 roblevi01 WAS         86      33       3    17   139              53
10 sotoju01  WAS         73      25       1    22   121              48
# ℹ 457 more rows</code></pre>
</div>
</div>
<ul>
<li><p>We can of course use lots of functions when creating a new variable as well. Some common functions are <code>log()</code>, <code>lead()</code>, <code>lag()</code>, <code>percent_rank()</code>, <code>cumsum()</code>, etc. (see the help for <code>mutate</code> for a nice list).</p>
<ul>
<li>Let’s use <code>percent_rank()</code> to get a new column telling us where they rank for number of hits</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>batting_tbl <span class="sc">|&gt;</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(G <span class="sc">&gt;</span> <span class="dv">100</span>, yearID <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2018</span>, <span class="dv">2019</span>, <span class="dv">2020</span>)) <span class="sc">|&gt;</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(teamID), playerID) <span class="sc">|&gt;</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(playerID, teamID, H<span class="sc">:</span>HR) <span class="sc">|&gt;</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Doubles"</span> <span class="ot">=</span> <span class="st">"X2B"</span>, <span class="st">"Triples"</span> <span class="ot">=</span> <span class="st">"X3B"</span>) <span class="sc">|&gt;</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Extra_Base_Hits =</span> Doubles <span class="sc">+</span> Triples <span class="sc">+</span> HR,</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">Singles =</span> H <span class="sc">-</span> Extra_Base_Hits,</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">H_Percentile =</span> <span class="fu">percent_rank</span>(H)) <span class="sc">|&gt;</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(playerID, teamID, H, H_Percentile, <span class="fu">everything</span>()) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 467 × 9
   playerID  teamID     H H_Percentile Doubles Triples    HR Extra_Base_Hits
   &lt;chr&gt;     &lt;fct&gt;  &lt;int&gt;        &lt;dbl&gt;   &lt;int&gt;   &lt;int&gt; &lt;int&gt;           &lt;int&gt;
 1 adamsma01 WAS       70       0.0536      14       0    20              34
 2 difowi01  WAS       94       0.223       14       7     7              28
 3 doziebr01 WAS       99       0.266       20       0    20              40
 4 eatonad02 WAS      158       0.830       25       7    15              47
 5 harpebr03 WAS      137       0.665       34       0    34              68
 6 kendrho01 WAS      115       0.436       23       1    17              41
 7 rendoan01 WAS      163       0.865       44       2    24              70
 8 rendoan01 WAS      174       0.923       44       3    34              81
 9 roblevi01 WAS      139       0.687       33       3    17              53
10 sotoju01  WAS      121       0.517       25       1    22              48
# ℹ 457 more rows
# ℹ 1 more variable: Singles &lt;int&gt;</code></pre>
</div>
</div>
<ul>
<li>A common comparison we want to do is to take a particular value and compare it to its mean. Let’s add in a mean variable for hits as well.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>batting_tbl <span class="sc">|&gt;</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(G <span class="sc">&gt;</span> <span class="dv">100</span>, yearID <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2018</span>, <span class="dv">2019</span>, <span class="dv">2020</span>)) <span class="sc">|&gt;</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(teamID), playerID) <span class="sc">|&gt;</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(playerID, teamID, H<span class="sc">:</span>HR) <span class="sc">|&gt;</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Doubles"</span> <span class="ot">=</span> <span class="st">"X2B"</span>, <span class="st">"Triples"</span> <span class="ot">=</span> <span class="st">"X3B"</span>) <span class="sc">|&gt;</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Extra_Base_Hits =</span> Doubles <span class="sc">+</span> Triples <span class="sc">+</span> HR,</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">Singles =</span> H <span class="sc">-</span> Extra_Base_Hits,</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">H_Percentile =</span> <span class="fu">percent_rank</span>(H),</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">H_Mean =</span> <span class="fu">mean</span>(H)) <span class="sc">|&gt;</span></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(playerID, teamID, H, H_Mean, H_Percentile, <span class="fu">everything</span>()) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 467 × 10
   playerID  teamID     H H_Mean H_Percentile Doubles Triples    HR
   &lt;chr&gt;     &lt;fct&gt;  &lt;int&gt;  &lt;dbl&gt;        &lt;dbl&gt;   &lt;int&gt;   &lt;int&gt; &lt;int&gt;
 1 adamsma01 WAS       70   121.       0.0536      14       0    20
 2 difowi01  WAS       94   121.       0.223       14       7     7
 3 doziebr01 WAS       99   121.       0.266       20       0    20
 4 eatonad02 WAS      158   121.       0.830       25       7    15
 5 harpebr03 WAS      137   121.       0.665       34       0    34
 6 kendrho01 WAS      115   121.       0.436       23       1    17
 7 rendoan01 WAS      163   121.       0.865       44       2    24
 8 rendoan01 WAS      174   121.       0.923       44       3    34
 9 roblevi01 WAS      139   121.       0.687       33       3    17
10 sotoju01  WAS      121   121.       0.517       25       1    22
# ℹ 457 more rows
# ℹ 2 more variables: Extra_Base_Hits &lt;int&gt;, Singles &lt;int&gt;</code></pre>
</div>
</div>
<ul>
<li><p>Useful, but what if we want to show the mean by team? Easy to do in <code>dplyr</code> using <code>group_by()</code>!</p></li>
<li><p>If we add <code>group_by()</code> in our chain, any summary statistics created will honor those groups (<code>ungroup()</code> exists if you want to remove a grouping).</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>batting_tbl <span class="sc">|&gt;</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(G <span class="sc">&gt;</span> <span class="dv">100</span>, yearID <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2018</span>, <span class="dv">2019</span>, <span class="dv">2020</span>)) <span class="sc">|&gt;</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(teamID), playerID) <span class="sc">|&gt;</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(playerID, teamID, H<span class="sc">:</span>HR) <span class="sc">|&gt;</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Doubles"</span> <span class="ot">=</span> <span class="st">"X2B"</span>, <span class="st">"Triples"</span> <span class="ot">=</span> <span class="st">"X3B"</span>) <span class="sc">|&gt;</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(teamID)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 467 × 6
# Groups:   teamID [30]
   playerID  teamID     H Doubles Triples    HR
   &lt;chr&gt;     &lt;fct&gt;  &lt;int&gt;   &lt;int&gt;   &lt;int&gt; &lt;int&gt;
 1 adamsma01 WAS       70      14       0    20
 2 difowi01  WAS       94      14       7     7
 3 doziebr01 WAS       99      20       0    20
 4 eatonad02 WAS      158      25       7    15
 5 harpebr03 WAS      137      34       0    34
 6 kendrho01 WAS      115      23       1    17
 7 rendoan01 WAS      163      44       2    24
 8 rendoan01 WAS      174      44       3    34
 9 roblevi01 WAS      139      33       3    17
10 sotoju01  WAS      121      25       1    22
# ℹ 457 more rows</code></pre>
</div>
</div>
<ul>
<li>Notice there is now an additional attribute associated with this <code>tibble</code>!</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>batting_tbl <span class="sc">|&gt;</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(G <span class="sc">&gt;</span> <span class="dv">100</span>, yearID <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2018</span>, <span class="dv">2019</span>, <span class="dv">2020</span>)) <span class="sc">|&gt;</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(teamID), playerID) <span class="sc">|&gt;</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(playerID, teamID, H<span class="sc">:</span>HR) <span class="sc">|&gt;</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Doubles"</span> <span class="ot">=</span> <span class="st">"X2B"</span>, <span class="st">"Triples"</span> <span class="ot">=</span> <span class="st">"X3B"</span>) <span class="sc">|&gt;</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(teamID) <span class="sc">|&gt;</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">attributes</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$class
[1] "grouped_df" "tbl_df"     "tbl"        "data.frame"

$row.names
  [1]   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17  18
 [19]  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35  36
 [37]  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53  54
 [55]  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71  72
 [73]  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89  90
 [91]  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107 108
[109] 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126
[127] 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144
[145] 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162
[163] 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180
[181] 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198
[199] 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216
[217] 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234
[235] 235 236 237 238 239 240 241 242 243 244 245 246 247 248 249 250 251 252
[253] 253 254 255 256 257 258 259 260 261 262 263 264 265 266 267 268 269 270
[271] 271 272 273 274 275 276 277 278 279 280 281 282 283 284 285 286 287 288
[289] 289 290 291 292 293 294 295 296 297 298 299 300 301 302 303 304 305 306
[307] 307 308 309 310 311 312 313 314 315 316 317 318 319 320 321 322 323 324
[325] 325 326 327 328 329 330 331 332 333 334 335 336 337 338 339 340 341 342
[343] 343 344 345 346 347 348 349 350 351 352 353 354 355 356 357 358 359 360
[361] 361 362 363 364 365 366 367 368 369 370 371 372 373 374 375 376 377 378
[379] 379 380 381 382 383 384 385 386 387 388 389 390 391 392 393 394 395 396
[397] 397 398 399 400 401 402 403 404 405 406 407 408 409 410 411 412 413 414
[415] 415 416 417 418 419 420 421 422 423 424 425 426 427 428 429 430 431 432
[433] 433 434 435 436 437 438 439 440 441 442 443 444 445 446 447 448 449 450
[451] 451 452 453 454 455 456 457 458 459 460 461 462 463 464 465 466 467

$names
[1] "playerID" "teamID"   "H"        "Doubles"  "Triples"  "HR"      

$groups
# A tibble: 30 × 2
   teamID       .rows
   &lt;fct&gt;  &lt;list&lt;int&gt;&gt;
 1 ARI           [14]
 2 ATL           [17]
 3 BAL           [12]
 4 BOS           [16]
 5 CHA           [14]
 6 CHN           [19]
 7 CIN           [17]
 8 CLE           [16]
 9 COL           [17]
10 DET           [11]
# ℹ 20 more rows</code></pre>
</div>
</div>
<ul>
<li>Let’s find our mean relative to each team using a <code>group_by()</code> in our chain (this finds the percentile by <code>teamID</code> as well).</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>batting_tbl <span class="sc">|&gt;</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(G <span class="sc">&gt;</span> <span class="dv">100</span>, yearID <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2018</span>, <span class="dv">2019</span>, <span class="dv">2020</span>)) <span class="sc">|&gt;</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(teamID), playerID) <span class="sc">|&gt;</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(playerID, teamID, H<span class="sc">:</span>HR) <span class="sc">|&gt;</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Doubles"</span> <span class="ot">=</span> <span class="st">"X2B"</span>, <span class="st">"Triples"</span> <span class="ot">=</span> <span class="st">"X3B"</span>) <span class="sc">|&gt;</span></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(teamID) <span class="sc">|&gt;</span></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Extra_Base_Hits =</span> Doubles <span class="sc">+</span> Triples <span class="sc">+</span> HR,</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">Singles =</span> H <span class="sc">-</span> Extra_Base_Hits,</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">H_Percentile =</span> <span class="fu">percent_rank</span>(H),</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">H_Mean =</span> <span class="fu">mean</span>(H)) <span class="sc">|&gt;</span></span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(playerID, teamID, H, H_Mean, H_Percentile, <span class="fu">everything</span>()) <span class="sc">|&gt;</span></span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">50</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 467 × 10
# Groups:   teamID [30]
   playerID  teamID     H H_Mean H_Percentile Doubles Triples    HR
   &lt;chr&gt;     &lt;fct&gt;  &lt;int&gt;  &lt;dbl&gt;        &lt;dbl&gt;   &lt;int&gt;   &lt;int&gt; &lt;int&gt;
 1 adamsma01 WAS       70   131.       0           14       0    20
 2 difowi01  WAS       94   131.       0.154       14       7     7
 3 doziebr01 WAS       99   131.       0.231       20       0    20
 4 eatonad02 WAS      158   131.       0.769       25       7    15
 5 harpebr03 WAS      137   131.       0.462       34       0    34
 6 kendrho01 WAS      115   131.       0.308       23       1    17
 7 rendoan01 WAS      163   131.       0.846       44       2    24
 8 rendoan01 WAS      174   131.       0.923       44       3    34
 9 roblevi01 WAS      139   131.       0.538       33       3    17
10 sotoju01  WAS      121   131.       0.385       25       1    22
11 sotoju01  WAS      153   131.       0.615       32       5    34
12 taylomi02 WAS       80   131.       0.0769      22       3     6
13 turnetr01 WAS      180   131.       1           27       6    19
14 turnetr01 WAS      155   131.       0.692       37       5    19
15 diazal02  TOR      111   103.       0.625       26       0    18
16 drurybr01 TOR       91   103.       0.312       21       1    15
17 galvifr01 TOR      120   103.       0.75        24       1    18
18 grandcu01 TOR       74   103.       0.0625      21       1    11
19 grichra01 TOR      104   103.       0.5         32       1    25
20 grichra01 TOR      136   103.       1           29       5    31
21 guerrvl02 TOR      126   103.       0.875       26       2    15
22 hernate01 TOR      114   103.       0.688       29       7    22
23 hernate01 TOR       96   103.       0.375       19       2    26
24 janseda01 TOR       72   103.       0           12       1    13
25 moralke01 TOR      103   103.       0.438       15       0    21
26 pillake01 TOR      129   103.       0.938       40       2    15
27 smoakju01 TOR      122   103.       0.812       34       0    25
28 smoakju01 TOR       86   103.       0.25        16       0    22
29 solarya01 TOR      106   103.       0.562       20       0    17
30 tellero01 TOR       84   103.       0.188       19       0    21
31 travide01 TOR       83   103.       0.125       14       3    11
32 andruel01 TEX      165   113.       1           27       4    12
33 beltrad01 TEX      118   113.       0.562       23       1    15
34 chiriro01 TEX       80   113.       0.125       15       1    18
35 choosh01  TEX      148   113.       0.875       30       1    21
36 choosh01  TEX      149   113.       0.938       31       2    24
37 deshide02 TEX       72   113.       0           14       1     2
38 deshide02 TEX       89   113.       0.188       15       4     4
39 forsylo01 TEX       72   113.       0           17       1     7
40 gallojo01 TEX      103   113.       0.375       24       1    40
41 guzmaro01 TEX       91   113.       0.25        18       2    16
42 kineris01 TEX       93   113.       0.312       18       2     4
43 mazarno01 TEX      126   113.       0.688       25       1    20
44 mazarno01 TEX      115   113.       0.5         27       1    19
45 odorro01  TEX      120   113.       0.625       23       2    18
46 odorro01  TEX      107   113.       0.438       30       1    30
47 profaju01 TEX      133   113.       0.75        35       6    20
48 santada01 TEX      134   113.       0.812       23       6    28
49 adamewi01 TBA      135   130.       0.4         25       1    20
50 choiji01  TBA      107   130.       0.2         20       2    19
# ℹ 417 more rows
# ℹ 2 more variables: Extra_Base_Hits &lt;int&gt;, Singles &lt;int&gt;</code></pre>
</div>
</div>
<ul>
<li>We can get a secondary grouping too! Let’s group by year as well</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>batting_tbl <span class="sc">|&gt;</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(G <span class="sc">&gt;</span> <span class="dv">100</span>, yearID <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2018</span>, <span class="dv">2019</span>, <span class="dv">2020</span>)) <span class="sc">|&gt;</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(teamID), playerID) <span class="sc">|&gt;</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(playerID, yearID, teamID, H<span class="sc">:</span>HR) <span class="sc">|&gt;</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Doubles"</span> <span class="ot">=</span> <span class="st">"X2B"</span>, <span class="st">"Triples"</span> <span class="ot">=</span> <span class="st">"X3B"</span>) <span class="sc">|&gt;</span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(teamID, yearID) <span class="sc">|&gt;</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Extra_Base_Hits =</span> Doubles <span class="sc">+</span> Triples <span class="sc">+</span> HR,</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">Singles =</span> H <span class="sc">-</span> Extra_Base_Hits,</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">H_Percentile =</span> <span class="fu">percent_rank</span>(H),</span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">H_Mean =</span> <span class="fu">mean</span>(H)) <span class="sc">|&gt;</span></span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(playerID, teamID, yearID, H, H_Mean, H_Percentile, <span class="fu">everything</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 467 × 11
# Groups:   teamID, yearID [60]
   playerID  teamID yearID     H H_Mean H_Percentile Doubles Triples    HR
   &lt;chr&gt;     &lt;fct&gt;   &lt;int&gt; &lt;int&gt;  &lt;dbl&gt;        &lt;dbl&gt;   &lt;int&gt;   &lt;int&gt; &lt;int&gt;
 1 adamsma01 WAS      2019    70   133.        0          14       0    20
 2 difowi01  WAS      2018    94   129.        0.2        14       7     7
 3 doziebr01 WAS      2019    99   133.        0.143      20       0    20
 4 eatonad02 WAS      2019   158   133.        0.857      25       7    15
 5 harpebr03 WAS      2018   137   129.        0.6        34       0    34
 6 kendrho01 WAS      2019   115   133.        0.286      23       1    17
 7 rendoan01 WAS      2018   163   129.        0.8        44       2    24
 8 rendoan01 WAS      2019   174   133.        1          44       3    34
 9 roblevi01 WAS      2019   139   133.        0.429      33       3    17
10 sotoju01  WAS      2018   121   129.        0.4        25       1    22
# ℹ 457 more rows
# ℹ 2 more variables: Extra_Base_Hits &lt;int&gt;, Singles &lt;int&gt;</code></pre>
</div>
</div>
<p>We are really able to do a lot quickly with these functions! Nice. One other commonly used function in <code>mutate()</code> is <code>ifelse()</code> or <code>if_else()</code> (the <code>tidyverse</code> version with slightly more restrictive functionality).</p>
<ul>
<li><p>Let’s add a new variable that compares a number of hits to the mean. If it is more than the mean we’ll say “Great”, if it is less than the mean we’ll say “Needs some work”.</p>
<ul>
<li>Recall <code>ifelse()</code> takes in a vector of conditions as the first argument. The second argument is what to do when <code>TRUE</code> and the third what to do when <code>FALSE</code>.</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>batting_tbl <span class="sc">|&gt;</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(G <span class="sc">&gt;</span> <span class="dv">100</span>, yearID <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2018</span>, <span class="dv">2019</span>, <span class="dv">2020</span>)) <span class="sc">|&gt;</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(teamID), playerID) <span class="sc">|&gt;</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(playerID, yearID, teamID, H<span class="sc">:</span>HR) <span class="sc">|&gt;</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Doubles"</span> <span class="ot">=</span> <span class="st">"X2B"</span>, <span class="st">"Triples"</span> <span class="ot">=</span> <span class="st">"X3B"</span>) <span class="sc">|&gt;</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(teamID, yearID) <span class="sc">|&gt;</span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Extra_Base_Hits =</span> Doubles <span class="sc">+</span> Triples <span class="sc">+</span> HR,</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">Singles =</span> H <span class="sc">-</span> Extra_Base_Hits,</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">H_Percentile =</span> <span class="fu">percent_rank</span>(H),</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">H_Mean =</span> <span class="fu">mean</span>(H),</span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">Status =</span> <span class="fu">ifelse</span>(H <span class="sc">&gt;</span> H_Mean, </span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"Great"</span>, </span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"Needs some work"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(playerID, teamID, yearID, H, H_Mean, Status, H_Percentile, <span class="fu">everything</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 467 × 12
# Groups:   teamID, yearID [60]
   playerID teamID yearID     H H_Mean Status H_Percentile Doubles Triples    HR
   &lt;chr&gt;    &lt;fct&gt;   &lt;int&gt; &lt;int&gt;  &lt;dbl&gt; &lt;chr&gt;         &lt;dbl&gt;   &lt;int&gt;   &lt;int&gt; &lt;int&gt;
 1 adamsma… WAS      2019    70   133. Needs…        0          14       0    20
 2 difowi01 WAS      2018    94   129. Needs…        0.2        14       7     7
 3 doziebr… WAS      2019    99   133. Needs…        0.143      20       0    20
 4 eatonad… WAS      2019   158   133. Great         0.857      25       7    15
 5 harpebr… WAS      2018   137   129. Great         0.6        34       0    34
 6 kendrho… WAS      2019   115   133. Needs…        0.286      23       1    17
 7 rendoan… WAS      2018   163   129. Great         0.8        44       2    24
 8 rendoan… WAS      2019   174   133. Great         1          44       3    34
 9 roblevi… WAS      2019   139   133. Great         0.429      33       3    17
10 sotoju01 WAS      2018   121   129. Needs…        0.4        25       1    22
# ℹ 457 more rows
# ℹ 2 more variables: Extra_Base_Hits &lt;int&gt;, Singles &lt;int&gt;</code></pre>
</div>
</div>
</section>
<section id="quick-r-video" class="level3">
<h3 class="anchored" data-anchor-id="quick-r-video">Quick R Video</h3>
<p>Please pop this video out and watch it in the full panopto player!</p>
<iframe src="https://ncsu.hosted.panopto.com/Panopto/Pages/Embed.aspx?id=e6c52a4f-e12f-42b3-ba62-b17c010a973a&amp;autoplay=false&amp;offerviewer=true&amp;showtitle=true&amp;showbrand=true&amp;captions=false&amp;interactivity=all" height="405" width="720" style="border: 1px solid #464646;" allowfullscreen="" allow="autoplay" aria-label="Panopto Embedded Video Player" aria-description="19 - Manipulating Data with dplyr"></iframe>
<ul>
<li><a href="https://github.com/jbpost2/My_first_repo" target="_blank">Link to repo with files from video</a></li>
</ul>
</section>
<section id="recap" class="level3">
<h3 class="anchored" data-anchor-id="recap">Recap!</h3>
<p><code>dplyr</code> gives us a ton of functionality for doing common data manipulations</p>
<ul>
<li><code>as_tibble()</code> - coerce a data frame to a tibble</li>
<li><code>filter()</code> - subset rows</li>
<li><code>arrange()</code> - reorder rows</li>
<li><code>select()</code> - subset/reorder columns</li>
<li><code>rename()</code> - rename columns</li>
<li><code>mutate()</code> - add new variables to the tibble</li>
</ul>
<p>The functionality of selecting columns described in the help for <code>select()</code> can be used in many places across the <code>tidyverse</code> and the functions <code>group_by()</code> and <code>ifelse()</code> are really useful as well!</p>
<ul>
<li><a href="https://rstudio.github.io/cheatsheets/html/data-transformation.html"><code>dplyr</code> Cheat Sheet</a> (PDF version on the right hand side of the page)</li>
</ul>
<p>Use the table of contents on the left or the arrows at the bottom of this page to navigate to the next learning material!</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../Notes/18-Reading_Excel_Data.html" class="pagination-link" aria-label="Reading Excel Data">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Reading Excel Data</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../Notes/20-Manipulating_Data_with_tidyr.html" class="pagination-link" aria-label="Manipulating Data with `tidyr`">
        <span class="nav-page-text">Manipulating Data with <code>tidyr</code></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>